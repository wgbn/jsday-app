!function(){"use strict";function e(e,t,n,o,r){function a(){var e=n.defer();if(console.info("connect() isConnecting_",d),d===!1){var t={storeType:lf.schema.DataStoreType.INDEXED_DB};(ionic.Platform.isIOS()||ionic.Platform.isAndroid())&&(t={storeType:lf.schema.DataStoreType.WEB_SQL}),null===f.db_?(d=!0,c().connect(t).then(function(t){d=!1,f.db_=t,f.noteTable_=f.db_.getSchema().table(r.Note),window.db=t,e.resolve()})):e.resolve()}else e.reject("Still connecting to the database");return e.promise}function i(){var e=n.defer();return f.db_.select().from(f.noteTable_).exec().then(function(t){e.resolve(t.length>0)}),e.promise}function c(){var e=lf.schema.create("jsday-notas",1);return e.createTable(r.Note).addColumn("id",lf.Type.INTEGER).addColumn("palestra",lf.Type.STRING).addColumn("text",lf.Type.STRING).addPrimaryKey(["id"]).addIndex("idx_palestra",["palestra"]),e}function l(){t.debug("Attempt to connect to and seed the database"),a().then(function(){o.$broadcast("lovefield-starter-event:dbConnected"),i().then(function(e){})})}var s=null,u=null,d=!1,f={db_:s,noteTable_:u,connect:a,initDatabase:l};return f}angular.module("jsday").factory("dbService",e),e.$inject=["$http","$log","$q","$rootScope","TABLE"]}(),function(){"use strict";function e(e,t,n,o){function r(){n.show({template:"Carregando..."}),u.$loaded(function(e){n.hide()},function(e){n.hide(),o.alert({title:"Ops!",template:'<div style="text-align: center;">Não foi possível carregar os dados.<br>Verifique sua conexão.</div>',okType:"button-energized"})})}function a(){return u}function i(e){var t=null;return u.forEach(function(n){n.$id==e&&(t=n)}),t}function c(e){u.$add(e)}function l(e,t){s.child("palestras").child(e.$id).child(t).set(e[t])}var s=new Firebase("https://jsday-app.firebaseio.com"),u=e(s.child("palestras")),d={getPalestras:a,getPalestra:i,addPalestra:c,updatePalestra:l};return r(),d}angular.module("jsday").factory("fireService",e),e.$inject=["$firebaseArray","Utils","$ionicLoading","$ionicPopup"]}(),function(){"use strict";function e(e,t,n){function o(e,o){var r=t.defer();return n.connect().then(function(){var t=new Date,a=n.noteTable_.createRow({id:t.getTime(),palestra:e,text:o});n.db_.insertOrReplace().into(n.noteTable_).values([a]).exec().then(function(){r.resolve()})}),r.promise}function r(e,o){var r=t.defer();return n.connect().then(function(){n.db_.update(n.noteTable_).set(n.noteTable_.text,o).where(n.noteTable_.id.eq(e)).exec().then(function(){r.resolve()})}),r.promise}function a(){var e=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).exec().then(function(t){e.resolve(t)})},function(e){console.error("Failed: ",e)}),e.promise}function i(o){var r=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).where(n.noteTable_.id.eq(o)).exec().then(function(t){angular.isDefined(t)&&1===t.length?r.resolve(t[0]):(e.error("Note not found with id of: "+o,t),r.reject())})}),r.promise}function c(e){var o=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).where(n.noteTable_.palestra.eq(e)).exec().then(function(e){o.resolve(e)})}),o.promise}function l(e){var o=t.defer();return n.connect().then(function(){n.db_["delete"]().from(n.noteTable_).where(n.noteTable_.id.eq(e)).exec().then(function(){o.resolve()})}),o.promise}var s={add:o,edit:r,getAll:a,getById:i,getByPalestra:c,remove:l};return s}angular.module("jsday").factory("noteService",e),e.$inject=["$log","$q","dbService"]}(),function(){"use strict";function e(){function e(e,t){t=t||!1;var e=e.split(" "),n=new Date(e[0].split("/")[2],parseInt(e[0].split("/")[1])-1,e[0].split("/")[0],t?e[1].split(":")[0]:0,t?e[1].split(":")[1]:0,0,0);return n.getTime()}function t(e,t){t=t||!1;var n=new Date(e);return(n.getDate()<10?"0"+n.getDate():n.getDate())+"/"+(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"/"+n.getFullYear().toString()+(t?" "+n.getHours().toString()+":"+n.getMinutes().toString():"")}function n(e){var t=new Date(e);return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}function o(e){var t=new Date(e);return(t.getDate()<10?"0"+t.getDate():t.getDate())+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)}function r(e,t){localStorage.setItem(e,JSON.stringify(t))}function a(e){return JSON.parse(localStorage.getItem(e))}var i={parseStrToDate:e,parseDateToStr:t,parseTimeToStr:n,parseShortDateToStr:o,setLocalStorage:r,getLocalStorage:a};return i}angular.module("jsday").factory("Utils",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRic2VydmljZS5qcyIsImZpcmViYXNlU2VydmljZS5qcyIsIm5vdGVzZXJ2aWNlLmpzIiwidXRpbHMuanMiXSwibmFtZXMiOlsiZGJTZXJ2aWNlIiwiJGh0dHAiLCIkbG9nIiwiJHEiLCIkcm9vdFNjb3BlIiwiVEFCTEUiLCJjb25uZWN0IiwiZGVmZXJyZWQiLCJkZWZlciIsImNvbnNvbGUiLCJpbmZvIiwiaXNDb25uZWN0aW5nXyIsImNvbm5lY3Rpb25PcHRpb25zIiwic3RvcmVUeXBlIiwibGYiLCJzY2hlbWEiLCJEYXRhU3RvcmVUeXBlIiwiSU5ERVhFRF9EQiIsImlvbmljIiwiUGxhdGZvcm0iLCJpc0lPUyIsImlzQW5kcm9pZCIsIldFQl9TUUwiLCJzZXJ2aWNlIiwiZGJfIiwiYnVpbGRTY2hlbWEiLCJ0aGVuIiwiZGF0YWJhc2UiLCJub3RlVGFibGVfIiwiZ2V0U2NoZW1hIiwidGFibGUiLCJOb3RlIiwid2luZG93IiwiZGIiLCJyZXNvbHZlIiwicmVqZWN0IiwicHJvbWlzZSIsImNoZWNrRm9yRXhpc3RpbmdEYXRhIiwic2VsZWN0IiwiZnJvbSIsImV4ZWMiLCJyb3dzIiwibGVuZ3RoIiwic2NoZW1hQnVpbGRlciIsImNyZWF0ZSIsImNyZWF0ZVRhYmxlIiwiYWRkQ29sdW1uIiwiVHlwZSIsIklOVEVHRVIiLCJTVFJJTkciLCJhZGRQcmltYXJ5S2V5IiwiYWRkSW5kZXgiLCJpbml0RGF0YWJhc2UiLCJkZWJ1ZyIsIiRicm9hZGNhc3QiLCJkYXRhRXhpc3RzIiwiYW5ndWxhciIsIm1vZHVsZSIsImZhY3RvcnkiLCIkaW5qZWN0IiwiZmlyZVNlcnZpY2UiLCIkZmlyZWJhc2VBcnJheSIsIlV0aWxzIiwiJGlvbmljTG9hZGluZyIsIiRpb25pY1BvcHVwIiwiX2xvYWRpbmciLCJzaG93IiwidGVtcGxhdGUiLCJzeW5jIiwiJGxvYWRlZCIsIm9rIiwiaGlkZSIsImVycm8iLCJhbGVydCIsInRpdGxlIiwib2tUeXBlIiwiX2dldFBhbGVzdHJhcyIsIl9nZXRQYWxlc3RyYSIsIl9rZXkiLCJyZXN1bHQiLCJmb3JFYWNoIiwiX3ZhbCIsIiRpZCIsIl9hZGRQYWxlc3RyYSIsIl9wYWxlc3RyYSIsIiRhZGQiLCJfdXBkYXRlUGFsZXN0cmEiLCJfaXRlbSIsImNoaWxkIiwic2V0IiwiRmlyZWJhc2UiLCJfcmV0dXJuIiwiZ2V0UGFsZXN0cmFzIiwiZ2V0UGFsZXN0cmEiLCJhZGRQYWxlc3RyYSIsInVwZGF0ZVBhbGVzdHJhIiwibm90ZVNlcnZpY2UiLCJhZGQiLCJwYWxlc3RyYSIsInRleHQiLCJfaG9qZSIsIkRhdGUiLCJyb3ciLCJjcmVhdGVSb3ciLCJpZCIsImdldFRpbWUiLCJpbnNlcnRPclJlcGxhY2UiLCJpbnRvIiwidmFsdWVzIiwiZWRpdCIsInVwZGF0ZSIsIndoZXJlIiwiZXEiLCJnZXRBbGwiLCJyZWFzb24iLCJlcnJvciIsImdldEJ5SWQiLCJyZXN1bHRzIiwiaXNEZWZpbmVkIiwiZ2V0QnlQYWxlc3RyYSIsInJlbW92ZSIsIl9wYXJzZVN0clRvRGF0ZSIsIl9kYXRlIiwiX3RpbWUiLCJzcGxpdCIsInBhcnNlSW50IiwiX3BhcnNlRGF0ZVRvU3RyIiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJ0b1N0cmluZyIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsIl9wYXJzZVRpbWVUb1N0ciIsIl9wYXJzZVNob3J0RGF0ZVRvU3RyIiwiX3NldExvY2FsU3RvcmFnZSIsIl92YWxvciIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiX2dldExvY2FsU3RvcmFnZSIsInBhcnNlIiwiZ2V0SXRlbSIsInBhcnNlU3RyVG9EYXRlIiwicGFyc2VEYXRlVG9TdHIiLCJwYXJzZVRpbWVUb1N0ciIsInBhcnNlU2hvcnREYXRlVG9TdHIiLCJzZXRMb2NhbFN0b3JhZ2UiLCJnZXRMb2NhbFN0b3JhZ2UiXSwibWFwcGluZ3MiOiJDQU9BLFdBQ0EsWUFRQSxTQUFBQSxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFB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QUEsU0FDQUMsUUFBQSxRQUFBSSIsImZpbGUiOiJzZXJ2aWNlcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRoaXMgaXMgaW5zcGlyZWQgYnkvcmlwcGVkIG9mZiBmcm9tIHZhcmlvdXMgYml0cyBvZiBMb3ZlRmllbGQgZGVtbyBjb2RlOlxuICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZXNhbXBsZXMvaW8yMDE1LWNvZGVsYWJzL2Jsb2IvbWFzdGVyL2xvdmVmaWVsZC9zcmMvZmluYWwvbG92ZWZpZWxkX3NlcnZpY2UuanNcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RlbW9zL29seW1waWFfZGIvYW5ndWxhci9kZW1vLmpzXG4gKiBUaGFuayB5b3UhXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2pzZGF5JylcbiAgICAgICAgLmZhY3RvcnkoJ2RiU2VydmljZScsIGRiU2VydmljZSk7XG5cbiAgICBkYlNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJGxvZycsICckcScsICckcm9vdFNjb3BlJywgJ1RBQkxFJ107XG5cbiAgICBmdW5jdGlvbiBkYlNlcnZpY2UoJGh0dHAsICRsb2csICRxLCAkcm9vdFNjb3BlLCBUQUJMRSkge1xuICAgICAgICB2YXIgZGJfID0gbnVsbDtcbiAgICAgICAgdmFyIG5vdGVUYWJsZV8gPSBudWxsO1xuICAgICAgICB2YXIgaXNDb25uZWN0aW5nXyA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgZGJfOiBkYl8sXG4gICAgICAgICAgICBub3RlVGFibGVfOiBub3RlVGFibGVfLFxuXG4gICAgICAgICAgICBjb25uZWN0OiBjb25uZWN0LFxuICAgICAgICAgICAgaW5pdERhdGFiYXNlOiBpbml0RGF0YWJhc2VcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgICAvLy8vLy8vLy8vLy9cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWFsaXplcyBhIGRhdGFiYXNlIGNvbm5lY3Rpb24uXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2V9IC0gcHJvbWlzZSBpcyByZXNvbHZlZCB3aGVuIHRoZSBkYl8gYW5kIG5vdGVUYWJsZV8gcHJvcGVydGllcyBoYXZlIGhhZCB2YWx1ZXMgYXNzaWduZWQgdG8gdGhlbVxuICAgICAgICAgKlxuICAgICAgICAgKiBOT1RFOiAyMDE1LzEwLzEwXG4gICAgICAgICAqICAgICAgIFdoZW4gbm8gY29ubmVjdGlvbiBvcHRpb25zIGFyZSBzZXQgTG92ZUZpZWxkIGRvZXMgc29tZSBmZWF0dXJlIGRldGVjdGlvbiB0byBkZXRlcm1pbmUgd2hpY2ggYmFja2luZyBzdG9yZSB0byB1c2UuXG4gICAgICAgICAqICAgICAgIElmIHRoZSBicm93c2VyIHN1cHBvcnRzIEluZGV4ZWREYiBpdCB1c2VzIHRoYXQsIHRoZW4gZmFsbHMgYmFjayB0byBXZWJTcWwgYW5kIGZpbmFsbHkgdG8gYW4gXCJpbiBtZW1vcnlcIiBkYXRhIHN0b3JlLlxuICAgICAgICAgKiAgICAgICBJIGZvdW5kIHdoZW4gZGVidWdnaW5nIG9uIGFjdHVhbCBkZXZpY2VzIHRoYXQgTG92ZUZpZWxkIGNob3NlIHRoZSBpbiBtZW1vcnkgKGxmLnNjaGVtYS5EYXRhU3RvcmVUeXBlLk1FTU9SWSkgc3RvcmVcbiAgICAgICAgICogICAgICAgb24gaU9TIHdoaWNoIGRpZG4ndCB3b3JrIHNvIHdlbGwgc28gaGVyZSB3ZSBlbnN1cmUgV2ViU3FsIGlzIHVzZWQgZm9yIGlPUyBhbmQgQW5kcm9pZCBkZXZpY2VzLlxuICAgICAgICAgKiAgICAgICBJbmRleGVkRGIgc2VlbWVkIHRvIHdvcmsgd2VsbCBvbiBkZXNrdG9wIGJyb3dzZXJzLlxuICAgICAgICAgKiAgICAgICBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL3NwZWMvMDNfbGlmZV9vZl9kYi5tZCMzMTEtY29ubmVjdC1vcHRpb25zXG4gICAgICAgICAqICAgICAgIGh0dHBzOi8vY29yZG92YS5hcGFjaGUub3JnL2RvY3MvZW4vNS4xLjEvY29yZG92YS9zdG9yYWdlL3N0b3JhZ2UuaHRtbFxuICAgICAgICAgKiAgICAgICBodHRwOi8vY2FuaXVzZS5jb20vI2ZlYXQ9aW5kZXhlZGRiXG4gICAgICAgICAqICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3MvZGQvMDJfZGF0YV9zdG9yZS5tZCMyNS13ZWJzcWwtc3RvcmVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGNvbm5lY3QoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmluZm8oJ2Nvbm5lY3QoKSBpc0Nvbm5lY3RpbmdfJywgaXNDb25uZWN0aW5nXyk7XG5cbiAgICAgICAgICAgIGlmIChpc0Nvbm5lY3RpbmdfID09PSBmYWxzZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb25PcHRpb25zID0ge3N0b3JlVHlwZTogbGYuc2NoZW1hLkRhdGFTdG9yZVR5cGUuSU5ERVhFRF9EQn07XG4gICAgICAgICAgICAgICAgaWYgKGlvbmljLlBsYXRmb3JtLmlzSU9TKCkgfHwgaW9uaWMuUGxhdGZvcm0uaXNBbmRyb2lkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbk9wdGlvbnMgPSB7c3RvcmVUeXBlOiBsZi5zY2hlbWEuRGF0YVN0b3JlVHlwZS5XRUJfU1FMfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc2VydmljZS5kYl8gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNDb25uZWN0aW5nXyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJ1aWxkU2NoZW1hKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb25uZWN0KGNvbm5lY3Rpb25PcHRpb25zKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhYmFzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0Nvbm5lY3RpbmdfID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2UuZGJfID0gZGF0YWJhc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2Uubm90ZVRhYmxlXyA9IHNlcnZpY2UuZGJfLmdldFNjaGVtYSgpLnRhYmxlKFRBQkxFLk5vdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGIgPSBkYXRhYmFzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoJ1N0aWxsIGNvbm5lY3RpbmcgdG8gdGhlIGRhdGFiYXNlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hlY2tzIGlmIGFueSBkYXRhIGV4aXN0cyBpbiB0aGUgREIuXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2UuPCFib29sZWFuPn1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrRm9yRXhpc3RpbmdEYXRhKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgc2VydmljZS5kYl8uc2VsZWN0KCkuZnJvbShzZXJ2aWNlLm5vdGVUYWJsZV8pLmV4ZWMoKS50aGVuKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyb3dzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocm93cy5sZW5ndGggPiAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbnNlcnRzIHNlZWQgZGF0YSBpbnRvIHRoZSBEQi5cbiAgICAgICAgICogQHJldHVybiB7IWFuZ3VsYXIuJHEuUHJvbWlzZX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIC8qZnVuY3Rpb24gaW5zZXJ0U2VlZERhdGEoKSB7XG4gICAgICAgICAgICAkbG9nLmRlYnVnKCdQb3B1bGF0aW5nIGluaXRpYWwgTm90ZSBkYXRhJyk7XG5cbiAgICAgICAgICAgIHZhciB1cmwgPSBcIi4uL2pzL2RhdGEvbm90ZXMuanNvblwiO1xuICAgICAgICAgICAgaWYgKGlvbmljLlBsYXRmb3JtLmlzQW5kcm9pZCgpKSB7XG4gICAgICAgICAgICAgICAgdXJsID0gXCIvYW5kcm9pZF9hc3NldC93d3cvanMvZGF0YS9ub3Rlcy5qc29uXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlvbmljLlBsYXRmb3JtLmlzSU9TKCkpIHtcbiAgICAgICAgICAgICAgICB1cmwgPSBcImpzL2RhdGEvbm90ZXMuanNvblwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KHVybCkudGhlbihcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvd3MgPSByZXNwb25zZS5kYXRhLm1hcChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VydmljZS5ub3RlVGFibGVfLmNyZWF0ZVJvdyhvYmopO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VydmljZS5kYl8uaW5zZXJ0KClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5pbnRvKHNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgICAgIC52YWx1ZXMocm93cylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5leGVjKCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSovXG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQnVpbGRzIHRoZSBkYXRhYmFzZSBzY2hlbWEuXG4gICAgICAgICAqIEByZXR1cm4geyFsZi5zY2hlbWEuQnVpbGRlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogVE9ETzogdGhpcyBpcyB3aGVyZSB5b3Ugd291bGQgZGVmaW5lIHlvdXIgZGF0YWJhc2UgdGFibGVzXG4gICAgICAgICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wMV9zY2hlbWEubWRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkU2NoZW1hKCkge1xuICAgICAgICAgICAgdmFyIHNjaGVtYUJ1aWxkZXIgPSBsZi5zY2hlbWEuY3JlYXRlKCdqc2RheS1ub3RhcycsIDEpO1xuICAgICAgICAgICAgc2NoZW1hQnVpbGRlclxuICAgICAgICAgICAgICAgIC5jcmVhdGVUYWJsZShUQUJMRS5Ob3RlKVxuICAgICAgICAgICAgICAgIC5hZGRDb2x1bW4oJ2lkJywgbGYuVHlwZS5JTlRFR0VSKVxuICAgICAgICAgICAgICAgIC5hZGRDb2x1bW4oJ3BhbGVzdHJhJywgbGYuVHlwZS5TVFJJTkcpXG4gICAgICAgICAgICAgICAgLmFkZENvbHVtbigndGV4dCcsIGxmLlR5cGUuU1RSSU5HKVxuICAgICAgICAgICAgICAgIC5hZGRQcmltYXJ5S2V5KFsnaWQnXSlcbiAgICAgICAgICAgICAgICAuYWRkSW5kZXgoJ2lkeF9wYWxlc3RyYScsIFsncGFsZXN0cmEnXSk7XG4gICAgICAgICAgICByZXR1cm4gc2NoZW1hQnVpbGRlcjtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvbm5lY3RzIHRvIGFuZCBzZWVkcyB0aGUgZGF0YWJhc2Ugd2l0aCBzb21lIGR1bW15IGRhdGEgaWYgbm8gZGF0YSBleGlzdHMuXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBpbml0RGF0YWJhc2UoKSB7XG4gICAgICAgICAgICAkbG9nLmRlYnVnKCdBdHRlbXB0IHRvIGNvbm5lY3QgdG8gYW5kIHNlZWQgdGhlIGRhdGFiYXNlJyk7XG4gICAgICAgICAgICBjb25uZWN0KCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb3ZlZmllbGQtc3RhcnRlci1ldmVudDpkYkNvbm5lY3RlZCcpO1xuICAgICAgICAgICAgICAgIGNoZWNrRm9yRXhpc3RpbmdEYXRhKCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGFFeGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qaWYgKGRhdGFFeGlzdHMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0U2VlZERhdGEoKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvdmVmaWVsZC1zdGFydGVyLWV2ZW50OnNlZWREYXRhSW5zZXJ0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiBTZXJ2acOnb2EgZGUgYWJzdHJhw6fDo28gZG8gRmlyZWJhc2VcbiAgICAgKiBAYXV0aG9yIFdhbHRlciBHYW5kYXJlbGxhIDx3YWx0ZXIud2dibkBnbWFpbC5jb20+XG4gICAgICogQG1lbWJlcm9mIGpzZGF5XG4gICAgICogQHZlcnNpb24gMS4wLjBcbiAgICAgKi9cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2pzZGF5JylcbiAgICAgICAgLmZhY3RvcnkoJ2ZpcmVTZXJ2aWNlJywgZmlyZVNlcnZpY2UpO1xuXG4gICAgZmlyZVNlcnZpY2UuJGluamVjdCA9IFsnJGZpcmViYXNlQXJyYXknLCAnVXRpbHMnLCAnJGlvbmljTG9hZGluZycsICckaW9uaWNQb3B1cCddO1xuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIGpzZGF5XG4gICAgICogQG5nZG9jIGZhY3RvcnlcbiAgICAgKiBAbmFtZSBmaXJlU2VydmljZVxuICAgICAqIEBwYXJhbSB7cHJvdmlkZXJ9ICRmaXJlYmFzZUFycmF5IEFic3RyYcOnw6NvIGRvIEZpcmViYXNlIEFycmF5XG4gICAgICogQHBhcmFtIHtmYWN0b3J5fSBVdGlscyBDb25qdW50byBkZSBmdW7Dp8O1ZXMgZGUgdXRpbGlkYWRlXG4gICAgICogQHBhcmFtIHtwcm92aWRlcn0gJGlvbmljTG9hZGluZyBQcm92aWRlciBwYXJhIGxvYWRlciBkaXJlY3RpdmVcbiAgICAgKiBAcGFyYW0ge3Byb3ZpZGVyfSAkaW9uaWNQb3B1cCBwcm92aWRlciBwYXJhIHBvcHVwIGRpcmVjdGl2ZVxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqICAgTWFuaXB1bGEgb3MgZGFkb3MgZSBmYXogbyBhY2Vzc28gw6EgYmFzZSBkbyBGaXJlYmFzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZpcmVTZXJ2aWNlICgkZmlyZWJhc2VBcnJheSwgVXRpbHMsICRpb25pY0xvYWRpbmcsICRpb25pY1BvcHVwKSB7XG5cbiAgICAgICAgdmFyIGRiID0gbmV3IEZpcmViYXNlKFwiaHR0cHM6Ly9qc2RheS1hcHAuZmlyZWJhc2Vpby5jb21cIik7IC8vLm9yZGVyQnlDaGlsZCgnZXZlbnRfc3RhcnQnKS5zdGFydEF0KG5ldyBEYXRlKCkuZ2V0VGltZSgpKTtcbiAgICAgICAgdmFyIHN5bmMgPSAkZmlyZWJhc2VBcnJheShkYi5jaGlsZCgncGFsZXN0cmFzJykpO1xuXG4gICAgICAgIHZhciBfcmV0dXJuID0ge1xuICAgICAgICAgICAgZ2V0UGFsZXN0cmFzOiAgIF9nZXRQYWxlc3RyYXMsXG4gICAgICAgICAgICBnZXRQYWxlc3RyYTogICAgX2dldFBhbGVzdHJhLFxuICAgICAgICAgICAgYWRkUGFsZXN0cmE6ICAgIF9hZGRQYWxlc3RyYSxcbiAgICAgICAgICAgIHVwZGF0ZVBhbGVzdHJhOiBfdXBkYXRlUGFsZXN0cmFcbiAgICAgICAgfTtcblxuICAgICAgICBfbG9hZGluZygpO1xuXG4gICAgICAgIHJldHVybiBfcmV0dXJuO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFc2N1dGEgbyBjYXJyZWdhbWVudG8gaW5pY2lhbCBkbyBhcnJheSB2aW5kbyBkbyBGaXJlYmFzZSBleGliaW5kbyB1bSBpb25pY0xvYWRlclxuICAgICAgICAgKiBAbWVtYmVyb2YgZmlyZVNlcnZpY2VcbiAgICAgICAgICogQGZ1bmN0aW9uIF9sb2FkaW5nXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfbG9hZGluZyAoKSB7XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLnNob3coe3RlbXBsYXRlOiAnQ2FycmVnYW5kby4uLid9KTtcbiAgICAgICAgICAgIHN5bmMuJGxvYWRlZChmdW5jdGlvbiAob2spIHtcbiAgICAgICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvKSB7XG4gICAgICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ09wcyEnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7XCI+TsOjbyBmb2kgcG9zc8OtdmVsIGNhcnJlZ2FyIG9zIGRhZG9zLjxicj5WZXJpZmlxdWUgc3VhIGNvbmV4w6NvLjwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgIG9rVHlwZTogJ2J1dHRvbi1lbmVyZ2l6ZWQnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXRvcm5hIGEgbGlzdGEgZGUgcGFsZXN0cmFzIHZpbmRhIGRvIGZpcmViYXNlXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2xvYWRpbmdcbiAgICAgICAgICogQHJldHVybnMge0FycmF5fSAgICAgICAgIExpc3RhIGRlIHBhbGVzdHJhc1xuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX2dldFBhbGVzdHJhcyAoKSB7XG4gICAgICAgICAgICByZXR1cm4gc3luYztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXRvcm5hIHVtYSBwYWxlc3RyYSBkYSBsaXN0YVxuICAgICAgICAgKiBAbWVtYmVyb2YgZmlyZVNlcnZpY2VcbiAgICAgICAgICogQGZ1bmN0aW9uIF9nZXRQYWxlc3RyYVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2tleSAgICAgQSBrZXkgZGEgcGFsZXN0cmEgbm8gYXJyYXlcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH0gICAgICAgIEEgcGFsZXN0cmEgZW5jb250cmFkYVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX2dldFBhbGVzdHJhIChfa2V5KSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcblxuICAgICAgICAgICAgc3luYy5mb3JFYWNoKGZ1bmN0aW9uIChfdmFsKSB7XG4gICAgICAgICAgICAgICAgaWYgKF92YWwuJGlkID09IF9rZXkpXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF92YWw7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGljaW9uYSB1bSBvYmpldG8gcGFsZXN0cmEgw6AgbGlzdGFcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfYWRkUGFsZXN0cmFcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IF9wYWxlc3RyYSAgICBPYmpldG8gcmVwcmVzZW50YW5kbyB1bWEgcGFsZXN0cmFcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9hZGRQYWxlc3RyYSAoX3BhbGVzdHJhKSB7XG4gICAgICAgICAgICBzeW5jLiRhZGQoX3BhbGVzdHJhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBdHVhbGl6YSB1bSBpdGVtIGRvIG9iamV0byBwYWxlc3RyYVxuICAgICAgICAgKiBAbWVtYmVyb2YgZmlyZVNlcnZpY2VcbiAgICAgICAgICogQGZ1bmN0aW9uIF91cGRhdGVQYWxlc3RyYVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gX3BhbGVzdHJhICAgIE9iamV0byByZXByZXNlbnRhbmRvIHVtYSBwYWxlc3RyYVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2l0ZW0gICAgICAgIENoYXZlIGRvIGl0ZW0gYSBzZXIgYXR1YWxpemFkb1xuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX3VwZGF0ZVBhbGVzdHJhIChfcGFsZXN0cmEsIF9pdGVtKSB7XG4gICAgICAgICAgICBkYi5jaGlsZCgncGFsZXN0cmFzJykuY2hpbGQoX3BhbGVzdHJhLiRpZCkuY2hpbGQoX2l0ZW0pLnNldChfcGFsZXN0cmFbX2l0ZW1dKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnanNkYXknKVxuICAgICAgICAuZmFjdG9yeSgnbm90ZVNlcnZpY2UnLCBub3RlU2VydmljZSk7XG5cbiAgICBub3RlU2VydmljZS4kaW5qZWN0ID0gWyckbG9nJywgJyRxJywgJ2RiU2VydmljZSddO1xuXG4gICAgZnVuY3Rpb24gbm90ZVNlcnZpY2UoJGxvZywgJHEsIGRiU2VydmljZSkge1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgYWRkOiBhZGQsXG4gICAgICAgICAgICBlZGl0OiBlZGl0LFxuICAgICAgICAgICAgZ2V0QWxsOiBnZXRBbGwsXG4gICAgICAgICAgICBnZXRCeUlkOiBnZXRCeUlkLFxuICAgICAgICAgICAgZ2V0QnlQYWxlc3RyYTogZ2V0QnlQYWxlc3RyYSxcbiAgICAgICAgICAgIHJlbW92ZTogcmVtb3ZlXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkcyBhIG5ldyBub3RlIHRvIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IC0gdGhlIHRleHQgb2YgdGhlIG5vdGUgdG8gdXBkYXRlXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2V9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBhZGQocGFsZXN0cmEsIHRleHQpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGRiU2VydmljZS5jb25uZWN0KCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9ob2plID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgcm93ID0gZGJTZXJ2aWNlLm5vdGVUYWJsZV8uY3JlYXRlUm93KHtcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogX2hvamUuZ2V0VGltZSgpLFxuICAgICAgICAgICAgICAgICAgICAncGFsZXN0cmEnOiBwYWxlc3RyYSxcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQnOiB0ZXh0XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgZG9jczogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9sb3ZlZmllbGQvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjLzA0X3F1ZXJ5Lm1kIzQyLWluc2VydC1xdWVyeS1idWlsZGVyXG4gICAgICAgICAgICAgICAgZGJTZXJ2aWNlLmRiXy5pbnNlcnRPclJlcGxhY2UoKVxuICAgICAgICAgICAgICAgICAgICAuaW50byhkYlNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgLnZhbHVlcyhbcm93XSlcbiAgICAgICAgICAgICAgICAgICAgLmV4ZWMoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVwZGF0ZXMgYSBub3RlIGluIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtndWlkfSAtIHRoZSBpZCBvZiB0aGUgbm90ZSB0byB1cGRhdGVcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IC0gdGhlIHRleHQgb2YgdGhlIG5vdGUgdG8gdXBkYXRlXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2V9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBlZGl0KGlkLCB0ZXh0KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wNF9xdWVyeS5tZCM0My11cGRhdGUtcXVlcnktYnVpbGRlclxuICAgICAgICAgICAgICAgIGRiU2VydmljZS5kYl8udXBkYXRlKGRiU2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAuc2V0KGRiU2VydmljZS5ub3RlVGFibGVfLnRleHQsIHRleHQpXG4gICAgICAgICAgICAgICAgICAgIC53aGVyZShkYlNlcnZpY2Uubm90ZVRhYmxlXy5pZC5lcShpZCkpXG4gICAgICAgICAgICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXRzIGFsbCBub3RlcyBmcm9tIHRoZSAgZGIuXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2UuPCFBcnJheTwhT2JqZWN0Pj59XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRBbGwoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogT2JzZXJ2ZSB0aGUgc2VsZWN0IHF1ZXJ5IHRvIHNhdmUgaGF2aW5nIHRvIGV4cGxpY2l0bHkgY2FsbCBnZXROb3RlcygpIGFmdGVyIGFuIElOU0VSVC9VUERBVEUgb3IgREVMRVRFIGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wNF9xdWVyeS5tZCM0Ni1vYnNlcnZlcnNcbiAgICAgICAgICAgICAgICAvLyBkYi5vYnNlcnZlKHNlbGVjdFF1ZXJ5LCBoYW5kbGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIFNFTEVDVCBkb2NzOiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL3NwZWMvMDRfcXVlcnkubWQjNDE4LXJldHJpZXZhbC1vZi1xdWVyeS1yZXN1bHRzXG4gICAgICAgICAgICAgICAgZGJTZXJ2aWNlLmRiXy5zZWxlY3QoKVxuICAgICAgICAgICAgICAgICAgICAuZnJvbShkYlNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgLmV4ZWMoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyb3dzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyb3dzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZDogJywgcmVhc29uKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldHMgYSBzaW5nbGUgbm90ZSBmcm9tIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtndWlkfSAtIHRoZSBpZCBvZiB0aGUgbm90ZSB0byByZXRyaWV2ZVxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlLjwhT2JqZWN0Pn1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldEJ5SWQoaWQpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGRiU2VydmljZS5jb25uZWN0KCkudGhlbihmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBkYlNlcnZpY2UuZGJfLnNlbGVjdCgpXG4gICAgICAgICAgICAgICAgICAgIC5mcm9tKGRiU2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAud2hlcmUoZGJTZXJ2aWNlLm5vdGVUYWJsZV8uaWQuZXEoaWQpKVxuICAgICAgICAgICAgICAgICAgICAuZXhlYygpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQocmVzdWx0cykgJiYgcmVzdWx0cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9nLmVycm9yKCdOb3RlIG5vdCBmb3VuZCB3aXRoIGlkIG9mOiAnICsgaWQsIHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEJ5UGFsZXN0cmEocGFsZXN0cmEpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGRiU2VydmljZS5jb25uZWN0KCkudGhlbihmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBkYlNlcnZpY2UuZGJfLnNlbGVjdCgpXG4gICAgICAgICAgICAgICAgICAgIC5mcm9tKGRiU2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAud2hlcmUoZGJTZXJ2aWNlLm5vdGVUYWJsZV8ucGFsZXN0cmEuZXEocGFsZXN0cmEpKVxuICAgICAgICAgICAgICAgICAgICAuZXhlYygpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWxldGVzIGEgbm90ZSBmcm9tIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtndWlkfSAtIHRoZSBpZCBvZiB0aGUgbm90ZSB0byByZXRyaWV2ZVxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlfSAtIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCBvbmNlIHRoZSByb3cgaGFzIGJlZW4gZGVsZXRlZFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKGlkKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy8gREVMRVRFIGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wNF9xdWVyeS5tZCM0NC1kZWxldGUtcXVlcnktYnVpbGRlclxuICAgICAgICAgICAgICAgIGRiU2VydmljZS5kYl8uZGVsZXRlKClcbiAgICAgICAgICAgICAgICAgICAgLmZyb20oZGJTZXJ2aWNlLm5vdGVUYWJsZV8pXG4gICAgICAgICAgICAgICAgICAgIC53aGVyZShkYlNlcnZpY2Uubm90ZVRhYmxlXy5pZC5lcShpZCkpXG4gICAgICAgICAgICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcmVhdGVzIGEgZ3VpZC5cbiAgICAgICAgICogQHJldHVybiB7Z3VpZH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogY29weS9wYXN0ZWQgZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMDUwNzQvMjY1MjkxMCAtIHRoYW5rIHlvdVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ3VpZCgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHM0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuICAgICAgICAgICAgICAgICAgICAudG9TdHJpbmcoMTYpXG4gICAgICAgICAgICAgICAgICAgIC5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiBCaWJsaW90ZWNhIGRlIGZ1bsOnw7VlcyB1dGlsaXTDoXJpYXNcbiAgICAgKiBAYXV0aG9yIFdhbHRlciBHYW5kYXJlbGxhIDx3YWx0ZXIud2dibkBnbWFpbC5jb20+XG4gICAgICogQG1lbWJlcm9mIGpzZGF5XG4gICAgICogQHZlcnNpb24gMS4wLjBcbiAgICAgKi9cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2pzZGF5JylcbiAgICAgICAgLmZhY3RvcnkoJ1V0aWxzJywgVXRpbHMpO1xuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIGpzZGF5XG4gICAgICogQG5nZG9jIGZhY3RvcnlcbiAgICAgKiBAbmFtZSBVdGlsc1xuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqICAgUHJvdsOqIGZ1bsOnw7VlcyB1dGlsaXTDoXJpYXMgcGFyYSB1c28gZGEgYXBsaWNhw6fDo29cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBVdGlscyAoKSB7XG4gICAgICAgIHZhciBfcmV0dXJuID0ge1xuICAgICAgICAgICAgcGFyc2VTdHJUb0RhdGU6ICAgICAgICAgX3BhcnNlU3RyVG9EYXRlLFxuICAgICAgICAgICAgcGFyc2VEYXRlVG9TdHI6ICAgICAgICAgX3BhcnNlRGF0ZVRvU3RyLFxuICAgICAgICAgICAgcGFyc2VUaW1lVG9TdHI6ICAgICAgICAgX3BhcnNlVGltZVRvU3RyLFxuICAgICAgICAgICAgcGFyc2VTaG9ydERhdGVUb1N0cjogICAgX3BhcnNlU2hvcnREYXRlVG9TdHIsXG4gICAgICAgICAgICBzZXRMb2NhbFN0b3JhZ2U6ICAgICAgICBfc2V0TG9jYWxTdG9yYWdlLFxuICAgICAgICAgICAgZ2V0TG9jYWxTdG9yYWdlOiAgICAgICAgX2dldExvY2FsU3RvcmFnZVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBfcmV0dXJuO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmFuc2Zvcm1hIHVtYSBzdHJpbmcgZm9ybWF0YWRhIGNvbW8gZGQvbW0veXl5eSBwYXJhIHVtIG9iamV0byBEYXRlXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX3BhcnNlU3RyVG9EYXRlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBfZGF0ZSAgICAgICAgRGF0YSBubyBmb3JtYXRvIGRkL21tL3l5eXlcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBfdGltZSAgICAgICBCb29sZWFubyBzZSBkZXZlIHNlciBjb25zaWRlcmFkbyBhIGhvcmFcbiAgICAgICAgICogQHJldHVybnMge251bWJlcn0gICAgICAgICAgICBUaW1lc3RhbXAgZGEgZGF0YVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX3BhcnNlU3RyVG9EYXRlIChfZGF0ZSwgX3RpbWUpIHtcbiAgICAgICAgICAgIF90aW1lID0gX3RpbWUgfHwgZmFsc2U7XG4gICAgICAgICAgICB2YXIgX2RhdGUgPSBfZGF0ZS5zcGxpdCgnICcpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKFxuICAgICAgICAgICAgICAgIF9kYXRlWzBdLnNwbGl0KCcvJylbMl0sXG4gICAgICAgICAgICAgICAgcGFyc2VJbnQoX2RhdGVbMF0uc3BsaXQoJy8nKVsxXSkgLSAxLFxuICAgICAgICAgICAgICAgIF9kYXRlWzBdLnNwbGl0KCcvJylbMF0sXG4gICAgICAgICAgICAgICAgX3RpbWUgPyBfZGF0ZVsxXS5zcGxpdCgnOicpWzBdIDogMCxcbiAgICAgICAgICAgICAgICBfdGltZSA/IF9kYXRlWzFdLnNwbGl0KCc6JylbMV0gOiAwLFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZ2V0VGltZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYW5zZm9ybWEgdW0gdGltZXN0YW1wIHBhcmEgZGF0YSBubyBmb3JtYXRvIGRkL21tL3l5eXkgW2hoOm1tXVxuICAgICAgICAgKiBAbWVtYmVyb2YgVXRpbHNcbiAgICAgICAgICogQGZ1bmN0aW9uIF9wYXJzZURhdGVUb1N0clxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gX2RhdGUgICAgICAgIFRpbWVzdGFtcCBkYSBkYXRhXG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gX3RpbWUgICAgICAgQm9vbGVhbm8gc2UgZGV2ZSBzZXIgY29uc2lkZXJhZG8gYSBob3JhXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9ICAgICAgICAgICAgQSBkYXRhIG5vIGZvcm1hdG8gZGQvbW0veXl5eSBbaGg6bW1dXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfcGFyc2VEYXRlVG9TdHIgKF9kYXRlLCBfdGltZSl7XG4gICAgICAgICAgICBfdGltZSA9IF90aW1lIHx8IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKF9kYXRlKTtcbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0LmdldERhdGUoKSA8IDEwID8gXCIwXCIrcmVzdWx0LmdldERhdGUoKSA6IHJlc3VsdC5nZXREYXRlKCkpXG4gICAgICAgICAgICAgICAgK1wiL1wiXG4gICAgICAgICAgICAgICAgKyhyZXN1bHQuZ2V0TW9udGgoKSsxIDwgMTAgPyBcIjBcIisocmVzdWx0LmdldE1vbnRoKCkrMSkgOiByZXN1bHQuZ2V0TW9udGgoKSsxKVxuICAgICAgICAgICAgICAgICtcIi9cIityZXN1bHQuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgKyhfdGltZSA/IFwiIFwiK3Jlc3VsdC5nZXRIb3VycygpLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICArXCI6XCJcbiAgICAgICAgICAgICAgICArcmVzdWx0LmdldE1pbnV0ZXMoKS50b1N0cmluZygpIDogXCJcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVHJhbnNmb3JtYSB1bSB0aW1lc3RhbXAgZW0gaG9yYSBubyBmb3JtYXRvIGhoOm1tXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX3BhcnNlVGltZVRvU3RyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBfZGF0ZSAgICAgICAgVGltZXN0YW1wIGRhIGRhdGFcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ30gICAgICAgICAgICBBIGhvcmEgbm8gZm9ybWF0byBoaDptbVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX3BhcnNlVGltZVRvU3RyIChfZGF0ZSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKF9kYXRlKTtcbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0LmdldEhvdXJzKCkgPCAxMCA/ICcwJyArIHJlc3VsdC5nZXRIb3VycygpIDogcmVzdWx0LmdldEhvdXJzKCkpXG4gICAgICAgICAgICAgICAgK1wiOlwiXG4gICAgICAgICAgICAgICAgKyhyZXN1bHQuZ2V0TWludXRlcygpIDwgMTAgPyAnMCcgKyByZXN1bHQuZ2V0TWludXRlcygpIDogcmVzdWx0LmdldE1pbnV0ZXMoKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVHJhbnNmb3JtYSB1bSB0aW1lc3RhbXAgbnVtYSBkYXRhIGN1cnRhIG5vIGZvcm1hdG8gZGQvbW1cbiAgICAgICAgICogQG1lbWJlcm9mIFV0aWxzXG4gICAgICAgICAqIEBmdW5jdGlvbiBfcGFyc2VTaG9ydERhdGVUb1N0clxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gX2RhdGUgICAgICAgIFRpbWVzdGFtcCBkYSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9ICAgICAgICAgICAgQSBkYXRhIG5vIGZvcm1hdG8gZGQvbW1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9wYXJzZVNob3J0RGF0ZVRvU3RyIChfZGF0ZSl7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IERhdGUoX2RhdGUpO1xuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQuZ2V0RGF0ZSgpIDwgMTAgPyBcIjBcIityZXN1bHQuZ2V0RGF0ZSgpIDogcmVzdWx0LmdldERhdGUoKSlcbiAgICAgICAgICAgICAgICArXCIvXCJcbiAgICAgICAgICAgICAgICArKHJlc3VsdC5nZXRNb250aCgpKzEgPCAxMCA/IFwiMFwiKyhyZXN1bHQuZ2V0TW9udGgoKSsxKSA6IHJlc3VsdC5nZXRNb250aCgpKzEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNhbHZhIHVtIGl0ZW0gbm8gbG9jYWxTdG9yYWdlIGRvIGRpc3Bvc2l0aXZvXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX3NldExvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2l0ZW0gICAgIENoYXZlIGRlIGlkZW50aWZpY2HDp8OjbyBkbyBpdGVtIG5vIGxvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gX3ZhbG9yICAgIFZhbG9yIGRvIGl0ZW1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9zZXRMb2NhbFN0b3JhZ2UgKF9pdGVtLCBfdmFsb3IpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKF9pdGVtLCBKU09OLnN0cmluZ2lmeShfdmFsb3IpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNnYXRhIHVtIGl0ZW0gc2Fsdm8gbm8gbG9jYWxTdG9yYWdlXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX2dldExvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2l0ZW0gICAgIENoYXZlIGRlIGlkZW50aWZpY2HDp8OjbyBkbyBpdGVtIG5vIGxvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSAgICAgICAgIEl0ZW0gZG8gbG9jYWxTdG9yYWdlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0TG9jYWxTdG9yYWdlIChfaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oX2l0ZW0pKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
