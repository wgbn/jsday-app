!function(){"use strict";function e(e,t,n,r,o){function a(){var e=n.defer();if(console.info("connect() isConnecting_",d),d===!1){var t={storeType:lf.schema.DataStoreType.INDEXED_DB};(ionic.Platform.isIOS()||ionic.Platform.isAndroid())&&(t={storeType:lf.schema.DataStoreType.WEB_SQL}),null===f.db_?(d=!0,c().connect(t).then(function(t){d=!1,f.db_=t,f.noteTable_=f.db_.getSchema().table(o.Note),window.db=t,e.resolve()})):e.resolve()}else e.reject("Still connecting to the database");return e.promise}function i(){var e=n.defer();return f.db_.select().from(f.noteTable_).exec().then(function(t){e.resolve(t.length>0)}),e.promise}function c(){var e=lf.schema.create("jsday-notas",1);return e.createTable(o.Note).addColumn("id",lf.Type.INTEGER).addColumn("palestra",lf.Type.STRING).addColumn("text",lf.Type.STRING).addPrimaryKey(["id"]).addIndex("idx_palestra",["palestra"]),e}function s(){t.debug("Attempt to connect to and seed the database"),a().then(function(){r.$broadcast("lovefield-starter-event:dbConnected"),i().then(function(e){})})}var l=null,u=null,d=!1,f={db_:l,noteTable_:u,connect:a,initDatabase:s};return f}angular.module("jsday").factory("dbService",e),e.$inject=["$http","$log","$q","$rootScope","TABLE"]}(),function(){"use strict";function e(e,t,n,r){function o(){n.show({template:"Carregando..."}),m.$loaded(function(e){n.hide()},function(e){n.hide(),r.alert({title:"Ops!",template:'<div style="text-align: center;">Não foi possível carregar os dados.<br>Verifique sua conexão.</div>',okType:"button-energized"})})}function a(){return m}function i(){return h}function c(e){var t=!1;return h.forEach(function(n){n.$id==e&&(t=n)}),t}function s(e){var t=null;return m.forEach(function(n){n.$id==e&&(t=n)}),t}function l(e){m.$add(e)}function u(e,t){p.child("palestras").child(e.$id).child(t).set(e[t])}function d(e,t){var n=new Date;return t.registro=n.getTime(),e.comentarios=e.comentarios||{},e.comentarios[n.getTime().toString()]=t,p.child("palestras").child(e.$id).child("comentarios").child(n.getTime().toString()).set(t),f(e)}function f(e){if(!e.comentarios)return{};var t=[];return Object.keys(e.comentarios).forEach(function(n){t.push(e.comentarios[n])}),t}var g={apiKey:"AIzaSyBdYNwQollKcyF6hQaJCfsVwKA0_GMi9Yc",authDomain:"jsday-app.firebaseapp.com",databaseURL:"https://jsday-app.firebaseio.com",storageBucket:"jsday-app.appspot.com"},p=(firebase.initializeApp(g),firebase.database().ref()),h=e(p.child("trilhas").orderByChild("timestamp")),m=e(p.child("palestras").orderByChild("hora")),b={getTrilhas:i,getTrilha:c,getPalestras:a,getPalestra:s,getComentarios:f,addPalestra:l,addComentario:d,updatePalestra:u};return o(),b}angular.module("jsday").factory("fireService",e),e.$inject=["$firebaseArray","Utils","$ionicLoading","$ionicPopup"]}(),function(){"use strict";function e(e,t,n){function r(e,r){var o=t.defer();return n.connect().then(function(){var t=new Date,a=n.noteTable_.createRow({id:t.getTime(),palestra:e,text:r});n.db_.insertOrReplace().into(n.noteTable_).values([a]).exec().then(function(){o.resolve()})}),o.promise}function o(e,r){var o=t.defer();return n.connect().then(function(){n.db_.update(n.noteTable_).set(n.noteTable_.text,r).where(n.noteTable_.id.eq(e)).exec().then(function(){o.resolve()})}),o.promise}function a(){var e=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).exec().then(function(t){e.resolve(t)})},function(e){console.error("Failed: ",e)}),e.promise}function i(r){var o=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).where(n.noteTable_.id.eq(r)).exec().then(function(t){angular.isDefined(t)&&1===t.length?o.resolve(t[0]):(e.error("Note not found with id of: "+r,t),o.reject())})}),o.promise}function c(e){var r=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).where(n.noteTable_.palestra.eq(e)).exec().then(function(e){r.resolve(e)})}),r.promise}function s(e){var r=t.defer();return n.connect().then(function(){n.db_["delete"]().from(n.noteTable_).where(n.noteTable_.id.eq(e)).exec().then(function(){r.resolve()})}),r.promise}var l={add:r,edit:o,getAll:a,getById:i,getByPalestra:c,remove:s};return l}angular.module("jsday").factory("noteService",e),e.$inject=["$log","$q","dbService"]}(),function(){"use strict";function e(){function e(e,t){t=t||!1;var e=e.split(" "),n=new Date(e[0].split("/")[2],parseInt(e[0].split("/")[1])-1,e[0].split("/")[0],t?e[1].split(":")[0]:0,t?e[1].split(":")[1]:0,0,0);return n.getTime()}function t(e,t){t=t||!1;var n=new Date(e);return(n.getDate()<10?"0"+n.getDate():n.getDate())+"/"+(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"/"+n.getFullYear().toString()+(t?" "+n.getHours().toString()+":"+n.getMinutes().toString():"")}function n(e){var t=new Date(e);return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}function r(e){var t=new Date(e);return(t.getDate()<10?"0"+t.getDate():t.getDate())+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)}function o(e,t){localStorage.setItem(e,JSON.stringify(t))}function a(e){return JSON.parse(localStorage.getItem(e))}var i={parseStrToDate:e,parseDateToStr:t,parseTimeToStr:n,parseShortDateToStr:r,setLocalStorage:o,getLocalStorage:a};return i}angular.module("jsday").factory("Utils",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRic2VydmljZS5qcyIsImZpcmViYXNlU2VydmljZS5qcyIsIm5vdGVzZXJ2aWNlLmpzIiwidXRpbHMuanMiXSwibmFtZXMiOlsiZGJTZXJ2aWNlIiwiJGh0dHAiLCIkbG9nIiwiJHEiLCIkcm9vdFNjb3BlIiwiVEFCTEUiLCJjb25uZWN0IiwiZGVmZXJyZWQiLCJkZWZlciIsImNvbnNvbGUiLCJpbmZvIiwiaXNDb25uZWN0aW5nXyIsImNvbm5lY3Rpb25PcHRpb25zIiwic3RvcmVUeXBlIiwibGYiLCJzY2hlbWEiLCJEYXRhU3RvcmVUeXBlIiwiSU5ERVhFRF9EQiIsImlvbmljIiwiUGxhdGZvcm0iLCJpc0lPUyIsImlzQW5kcm9pZCIsIldFQl9TUUwiLCJzZXJ2aWNlIiwiZGJfIiwiYnVpbGRTY2hlbWEiLCJ0aGVuIiwiZGF0YWJhc2UiLCJub3RlVGFibGVfIiwiZ2V0U2NoZW1hIiwidGFibGUiLCJOb3RlIiwid2luZG93IiwiZGIiLCJyZXNvbHZlIiwicmVqZWN0IiwicHJvbWlzZSIsImNoZWNrRm9yRXhpc3RpbmdEYXRhIiwic2VsZWN0IiwiZnJvbSIsImV4ZWMiLCJyb3dzIiwibGVuZ3RoIiwic2NoZW1hQnVpbGRlciIsImNyZWF0ZSIsImNyZWF0ZVRhYmxlIiwiYWRkQ29sdW1uIiwiVHlwZSIsIklOVEVHRVIiLCJTVFJJTkciLCJhZGRQcmltYXJ5S2V5IiwiYWRkSW5kZXgiLCJpbml0RGF0YWJhc2UiLCJkZWJ1ZyIsIiRicm9hZGNhc3QiLCJkYXRhRXhpc3RzIiwiYW5ndWxhciIsIm1vZHVsZSIsImZhY3RvcnkiLCIkaW5qZWN0IiwiZmlyZVNlcnZpY2UiLCIkZmlyZWJhc2VBcnJheSIsIlV0aWxzIiwiJGlvbmljTG9hZGluZyIsIiRpb25pY1BvcHVwIiwiX2xvYWRpbmciLCJzaG93IiwidGVtcGxhdGUiLCJzeW5jIiwiJGxvYWRlZCIsIm9rIiwiaGlkZSIsImVycm8iLCJhbGVydCIsInRpdGxlIiwib2tUeXBlIiwiX2dldFBhbGVzdHJhcyIsIl9nZXRUcmlsaGFzIiwidHJpbGhhcyIsIl9nZXRUcmlsaGEiLCJfaWQiLCJyZXN1bHQiLCJmb3JFYWNoIiwiX3QiLCIkaWQiLCJfZ2V0UGFsZXN0cmEiLCJfa2V5IiwiX3ZhbCIsIl9hZGRQYWxlc3RyYSIsIl9wYWxlc3RyYSIsIiRhZGQiLCJfdXBkYXRlUGFsZXN0cmEiLCJfaXRlbSIsImNoaWxkIiwic2V0IiwiX2FkZENvbWVudGFyaW8iLCJfY29tZW50YXJpbyIsIl9kdCIsIkRhdGUiLCJyZWdpc3RybyIsImdldFRpbWUiLCJjb21lbnRhcmlvcyIsInRvU3RyaW5nIiwiX2dldENvbWVudGFyaW9zIiwicmVzIiwiT2JqZWN0Iiwia2V5cyIsInB1c2giLCJjb25maWciLCJhcGlLZXkiLCJhdXRoRG9tYWluIiwiZGF0YWJhc2VVUkwiLCJzdG9yYWdlQnVja2V0IiwiZmlyZWJhc2UiLCJpbml0aWFsaXplQXBwIiwicmVmIiwib3JkZXJCeUNoaWxkIiwiX3JldHVybiIsImdldFRyaWxoYXMiLCJnZXRUcmlsaGEiLCJnZXRQYWxlc3RyYXMiLCJnZXRQYWxlc3RyYSIsImdldENvbWVudGFyaW9zIiwiYWRkUGFsZXN0cmEiLCJhZGRDb21lbnRhcmlvIiwidXBkYXRlUGFsZXN0cmEiLCJub3RlU2VydmljZSIsImFkZCIsInBhbGVzdHJhIiwidGV4dCIsIl9ob2plIiwicm93IiwiY3JlYXRlUm93IiwiaWQiLCJpbnNlcnRPclJlcGxhY2UiLCJpbnRvIiwidmFsdWVzIiwiZWRpdCIsInVwZGF0ZSIsIndoZXJlIiwiZXEiLCJnZXRBbGwiLCJyZWFzb24iLCJlcnJvciIsImdldEJ5SWQiLCJyZXN1bHRzIiwiaXNEZWZpbmVkIiwiZ2V0QnlQYWxlc3RyYSIsInJlbW92ZSIsIl9wYXJzZVN0clRvRGF0ZSIsIl9kYXRlIiwiX3RpbWUiLCJzcGxpdCIsInBhcnNlSW50IiwiX3BhcnNlRGF0ZVRvU3RyIiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJfcGFyc2VUaW1lVG9TdHIiLCJfcGFyc2VTaG9ydERhdGVUb1N0ciIsIl9zZXRMb2NhbFN0b3JhZ2UiLCJfdmFsb3IiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsIl9nZXRMb2NhbFN0b3JhZ2UiLCJwYXJzZSIsImdldEl0ZW0iLCJwYXJzZVN0clRvRGF0ZSIsInBhcnNlRGF0ZVRvU3RyIiwicGFyc2VUaW1lVG9TdHIiLCJwYXJzZVNob3J0RGF0ZVRvU3RyIiwic2V0TG9jYWxTdG9yYWdlIiwiZ2V0TG9jYWxTdG9yYWdlIl0sIm1hcHBpbmdzIjoiQ0FPQSxXQUNBLFlBUUEsU0FBQUEsR0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FpQ0EsUUFBQUMsS0FDQSxHQUFBQyxHQUFBSixFQUFBSyxPQUlBLElBRkFDLFFBQUFDLEtBQUEsMEJBQUFDLEdBRUFBLEtBQUEsRUFBQSxDQUVBLEdBQUFDLElBQUFDLFVBQUFDLEdBQUFDLE9BQUFDLGNBQUFDLGFBQ0FDLE1BQUFDLFNBQUFDLFNBQUFGLE1BQUFDLFNBQUFFLGVBQ0FULEdBQUFDLFVBQUFDLEdBQUFDLE9BQUFDLGNBQUFNLFVBR0EsT0FBQUMsRUFBQUMsS0FDQWIsR0FBQSxFQUNBYyxJQUNBbkIsUUFBQU0sR0FDQWMsS0FBQSxTQUNBQyxHQUNBaEIsR0FBQSxFQUNBWSxFQUFBQyxJQUFBRyxFQUNBSixFQUFBSyxXQUFBTCxFQUFBQyxJQUFBSyxZQUFBQyxNQUFBekIsRUFBQTBCLE1BQ0FDLE9BQUFDLEdBQUFOLEVBQ0FwQixFQUFBMkIsYUFHQTNCLEVBQUEyQixjQUdBM0IsR0FBQTRCLE9BQUEsbUNBR0EsT0FBQTVCLEdBQUE2QixRQVFBLFFBQUFDLEtBQ0EsR0FBQTlCLEdBQUFKLEVBQUFLLE9BUUEsT0FOQWUsR0FBQUMsSUFBQWMsU0FBQUMsS0FBQWhCLEVBQUFLLFlBQUFZLE9BQUFkLEtBQ0EsU0FBQWUsR0FDQWxDLEVBQUEyQixRQUFBTyxFQUFBQyxPQUFBLEtBSUFuQyxFQUFBNkIsUUF3Q0EsUUFBQVgsS0FDQSxHQUFBa0IsR0FBQTdCLEdBQUFDLE9BQUE2QixPQUFBLGNBQUEsRUFRQSxPQVBBRCxHQUNBRSxZQUFBeEMsRUFBQTBCLE1BQ0FlLFVBQUEsS0FBQWhDLEdBQUFpQyxLQUFBQyxTQUNBRixVQUFBLFdBQUFoQyxHQUFBaUMsS0FBQUUsUUFDQUgsVUFBQSxPQUFBaEMsR0FBQWlDLEtBQUFFLFFBQ0FDLGVBQUEsT0FDQUMsU0FBQSxnQkFBQSxhQUNBUixFQVFBLFFBQUFTLEtBQ0FsRCxFQUFBbUQsTUFBQSwrQ0FDQS9DLElBQUFvQixLQUFBLFdBQ0F0QixFQUFBa0QsV0FBQSx1Q0FDQWpCLElBQUFYLEtBQ0EsU0FBQTZCLFFBOUlBLEdBQUEvQixHQUFBLEtBQ0FJLEVBQUEsS0FDQWpCLEdBQUEsRUFFQVksR0FDQUMsSUFBQUEsRUFDQUksV0FBQUEsRUFFQXRCLFFBQUFBLEVBQ0E4QyxhQUFBQSxFQUdBLE9BQUE3QixHQW5CQWlDLFFBQ0FDLE9BQUEsU0FDQUMsUUFBQSxZQUFBMUQsR0FFQUEsRUFBQTJELFNBQUEsUUFBQSxPQUFBLEtBQUEsYUFBQSxZQ2RBLFdBQ0EsWUF5QkEsU0FBQUMsR0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FtQ0EsUUFBQUMsS0FDQUYsRUFBQUcsTUFBQUMsU0FBQSxrQkFDQUMsRUFBQUMsUUFBQSxTQUFBQyxHQUNBUCxFQUFBUSxRQUNBLFNBQUFDLEdBQ0FULEVBQUFRLE9BQ0FQLEVBQUFTLE9BQ0FDLE1BQUEsT0FDQVAsU0FBQSx1R0FDQVEsT0FBQSx1QkFZQSxRQUFBQyxLQUNBLE1BQUFSLEdBVUEsUUFBQVMsS0FDQSxNQUFBQyxHQVVBLFFBQUFDLEdBQUFDLEdBQ0EsR0FBQUMsSUFBQSxDQU9BLE9BTEFILEdBQUFJLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsS0FBQUosSUFDQUMsRUFBQUUsS0FHQUYsRUFXQSxRQUFBSSxHQUFBQyxHQUNBLEdBQUFMLEdBQUEsSUFPQSxPQUxBYixHQUFBYyxRQUFBLFNBQUFLLEdBQ0FBLEVBQUFILEtBQUFFLElBQ0FMLEVBQUFNLEtBR0FOLEVBVUEsUUFBQU8sR0FBQUMsR0FDQXJCLEVBQUFzQixLQUFBRCxHQVdBLFFBQUFFLEdBQUFGLEVBQUFHLEdBQ0EzRCxFQUFBNEQsTUFBQSxhQUFBQSxNQUFBSixFQUFBTCxLQUFBUyxNQUFBRCxHQUFBRSxJQUFBTCxFQUFBRyxJQVVBLFFBQUFHLEdBQUFOLEVBQUFPLEdBQ0EsR0FBQUMsR0FBQSxHQUFBQyxLQU9BLE9BTEFGLEdBQUFHLFNBQUFGLEVBQUFHLFVBQ0FYLEVBQUFZLFlBQUFaLEVBQUFZLGdCQUNBWixFQUFBWSxZQUFBSixFQUFBRyxVQUFBRSxZQUFBTixFQUVBL0QsRUFBQTRELE1BQUEsYUFBQUEsTUFBQUosRUFBQUwsS0FBQVMsTUFBQSxlQUFBQSxNQUFBSSxFQUFBRyxVQUFBRSxZQUFBUixJQUFBRSxHQUNBTyxFQUFBZCxHQVVBLFFBQUFjLEdBQUFkLEdBQ0EsSUFBQUEsRUFBQVksWUFDQSxRQUVBLElBQUFHLEtBSUEsT0FIQUMsUUFBQUMsS0FBQWpCLEVBQUFZLGFBQUFuQixRQUFBLFNBQUFJLEdBQ0FrQixFQUFBRyxLQUFBbEIsRUFBQVksWUFBQWYsTUFFQWtCLEVBbEtBLEdBQUFJLElBQ0FDLE9BQUEsMENBQ0FDLFdBQUEsNEJBQ0FDLFlBQUEsbUNBQ0FDLGNBQUEseUJBSUEvRSxHQUZBZ0YsU0FBQUMsY0FBQU4sR0FFQUssU0FBQXRGLFdBQUF3RixPQUNBckMsRUFBQWpCLEVBQUE1QixFQUFBNEQsTUFBQSxXQUFBdUIsYUFBQSxjQUNBaEQsRUFBQVAsRUFBQTVCLEVBQUE0RCxNQUFBLGFBQUF1QixhQUFBLFNBRUFDLEdBQ0FDLFdBQUF6QyxFQUNBMEMsVUFBQXhDLEVBQ0F5QyxhQUFBNUMsRUFDQTZDLFlBQUFwQyxFQUNBcUMsZUFBQW5CLEVBQ0FvQixZQUFBbkMsRUFDQW9DLGNBQUE3QixFQUNBOEIsZUFBQWxDLEVBS0EsT0FGQTFCLEtBRUFvRCxFQTVDQTdELFFBQ0FDLE9BQUEsU0FDQUMsUUFBQSxjQUFBRSxHQUVBQSxFQUFBRCxTQUFBLGlCQUFBLFFBQUEsZ0JBQUEsa0JDYkEsV0FDQSxZQVFBLFNBQUFtRSxHQUFBNUgsRUFBQUMsRUFBQUgsR0FxQkEsUUFBQStILEdBQUFDLEVBQUFDLEdBQ0EsR0FBQTFILEdBQUFKLEVBQUFLLE9BcUJBLE9BbkJBUixHQUFBTSxVQUFBb0IsS0FBQSxXQUNBLEdBQUF3RyxHQUFBLEdBQUFoQyxNQUNBaUMsRUFBQW5JLEVBQUE0QixXQUFBd0csV0FDQUMsR0FBQUgsRUFBQTlCLFVBQ0E0QixTQUFBQSxFQUNBQyxLQUFBQSxHQUlBakksR0FBQXdCLElBQUE4RyxrQkFDQUMsS0FBQXZJLEVBQUE0QixZQUNBNEcsUUFBQUwsSUFDQTNGLE9BQ0FkLEtBQ0EsV0FDQW5CLEVBQUEyQixjQUlBM0IsRUFBQTZCLFFBVUEsUUFBQXFHLEdBQUFKLEVBQUFKLEdBQ0EsR0FBQTFILEdBQUFKLEVBQUFLLE9BZUEsT0FiQVIsR0FBQU0sVUFBQW9CLEtBQUEsV0FHQTFCLEVBQUF3QixJQUFBa0gsT0FBQTFJLEVBQUE0QixZQUNBa0UsSUFBQTlGLEVBQUE0QixXQUFBcUcsS0FBQUEsR0FDQVUsTUFBQTNJLEVBQUE0QixXQUFBeUcsR0FBQU8sR0FBQVAsSUFDQTdGLE9BQ0FkLEtBQ0EsV0FDQW5CLEVBQUEyQixjQUlBM0IsRUFBQTZCLFFBUUEsUUFBQXlHLEtBQ0EsR0FBQXRJLEdBQUFKLEVBQUFLLE9BbUJBLE9BakJBUixHQUFBTSxVQUFBb0IsS0FBQSxXQU1BMUIsRUFBQXdCLElBQUFjLFNBQ0FDLEtBQUF2QyxFQUFBNEIsWUFDQVksT0FDQWQsS0FDQSxTQUFBZSxHQUNBbEMsRUFBQTJCLFFBQUFPLE1BRUEsU0FBQXFHLEdBQ0FySSxRQUFBc0ksTUFBQSxXQUFBRCxLQUdBdkksRUFBQTZCLFFBU0EsUUFBQTRHLEdBQUFYLEdBQ0EsR0FBQTlILEdBQUFKLEVBQUFLLE9BbUJBLE9BakJBUixHQUFBTSxVQUFBb0IsS0FBQSxXQUVBMUIsRUFBQXdCLElBQUFjLFNBQ0FDLEtBQUF2QyxFQUFBNEIsWUFDQStHLE1BQUEzSSxFQUFBNEIsV0FBQXlHLEdBQUFPLEdBQUFQLElBQ0E3RixPQUNBZCxLQUNBLFNBQUF1SCxHQUNBekYsUUFBQTBGLFVBQUFELElBQUEsSUFBQUEsRUFBQXZHLE9BQ0FuQyxFQUFBMkIsUUFBQStHLEVBQUEsS0FFQS9JLEVBQUE2SSxNQUFBLDhCQUFBVixFQUFBWSxHQUNBMUksRUFBQTRCLGNBS0E1QixFQUFBNkIsUUFHQSxRQUFBK0csR0FBQW5CLEdBQ0EsR0FBQXpILEdBQUFKLEVBQUFLLE9BY0EsT0FaQVIsR0FBQU0sVUFBQW9CLEtBQUEsV0FFQTFCLEVBQUF3QixJQUFBYyxTQUNBQyxLQUFBdkMsRUFBQTRCLFlBQ0ErRyxNQUFBM0ksRUFBQTRCLFdBQUFvRyxTQUFBWSxHQUFBWixJQUNBeEYsT0FDQWQsS0FDQSxTQUFBdUgsR0FDQTFJLEVBQUEyQixRQUFBK0csT0FJQTFJLEVBQUE2QixRQVNBLFFBQUFnSCxHQUFBZixHQUNBLEdBQUE5SCxHQUFBSixFQUFBSyxPQWVBLE9BYkFSLEdBQUFNLFVBQUFvQixLQUFBLFdBR0ExQixFQUFBd0IsSUFBQXhCLFlBQ0F1QyxLQUFBdkMsRUFBQTRCLFlBQ0ErRyxNQUFBM0ksRUFBQTRCLFdBQUF5RyxHQUFBTyxHQUFBUCxJQUNBN0YsT0FDQWQsS0FDQSxXQUNBbkIsRUFBQTJCLGNBSUEzQixFQUFBNkIsUUF2S0EsR0FBQWIsSUFDQXdHLElBQUFBLEVBQ0FVLEtBQUFBLEVBQ0FJLE9BQUFBLEVBQ0FHLFFBQUFBLEVBQ0FHLGNBQUFBLEVBQ0FDLE9BQUFBLEVBR0EsT0FBQTdILEdBakJBaUMsUUFDQUMsT0FBQSxTQUNBQyxRQUFBLGNBQUFvRSxHQUVBQSxFQUFBbkUsU0FBQSxPQUFBLEtBQUEsZ0JDUEEsV0FDQSxZQW1CQSxTQUFBRyxLQXFCQSxRQUFBdUYsR0FBQUMsRUFBQUMsR0FDQUEsRUFBQUEsSUFBQSxDQUNBLElBQUFELEdBQUFBLEVBQUFFLE1BQUEsS0FDQXZFLEVBQUEsR0FBQWlCLE1BQ0FvRCxFQUFBLEdBQUFFLE1BQUEsS0FBQSxHQUNBQyxTQUFBSCxFQUFBLEdBQUFFLE1BQUEsS0FBQSxJQUFBLEVBQ0FGLEVBQUEsR0FBQUUsTUFBQSxLQUFBLEdBQ0FELEVBQUFELEVBQUEsR0FBQUUsTUFBQSxLQUFBLEdBQUEsRUFDQUQsRUFBQUQsRUFBQSxHQUFBRSxNQUFBLEtBQUEsR0FBQSxFQUNBLEVBQ0EsRUFFQSxPQUFBdkUsR0FBQW1CLFVBWUEsUUFBQXNELEdBQUFKLEVBQUFDLEdBQ0FBLEVBQUFBLElBQUEsQ0FDQSxJQUFBdEUsR0FBQSxHQUFBaUIsTUFBQW9ELEVBQ0EsUUFBQXJFLEVBQUEwRSxVQUFBLEdBQUEsSUFBQTFFLEVBQUEwRSxVQUFBMUUsRUFBQTBFLFdBQ0EsS0FDQTFFLEVBQUEyRSxXQUFBLEVBQUEsR0FBQSxLQUFBM0UsRUFBQTJFLFdBQUEsR0FBQTNFLEVBQUEyRSxXQUFBLEdBQ0EsSUFBQTNFLEVBQUE0RSxjQUFBdkQsWUFDQWlELEVBQUEsSUFBQXRFLEVBQUE2RSxXQUFBeEQsV0FDQSxJQUNBckIsRUFBQThFLGFBQUF6RCxXQUFBLElBV0EsUUFBQTBELEdBQUFWLEdBQ0EsR0FBQXJFLEdBQUEsR0FBQWlCLE1BQUFvRCxFQUNBLFFBQUFyRSxFQUFBNkUsV0FBQSxHQUFBLElBQUE3RSxFQUFBNkUsV0FBQTdFLEVBQUE2RSxZQUNBLEtBQ0E3RSxFQUFBOEUsYUFBQSxHQUFBLElBQUE5RSxFQUFBOEUsYUFBQTlFLEVBQUE4RSxjQVdBLFFBQUFFLEdBQUFYLEdBQ0EsR0FBQXJFLEdBQUEsR0FBQWlCLE1BQUFvRCxFQUNBLFFBQUFyRSxFQUFBMEUsVUFBQSxHQUFBLElBQUExRSxFQUFBMEUsVUFBQTFFLEVBQUEwRSxXQUNBLEtBQ0ExRSxFQUFBMkUsV0FBQSxFQUFBLEdBQUEsS0FBQTNFLEVBQUEyRSxXQUFBLEdBQUEzRSxFQUFBMkUsV0FBQSxHQVdBLFFBQUFNLEdBQUF0RSxFQUFBdUUsR0FDQUMsYUFBQUMsUUFBQXpFLEVBQUEwRSxLQUFBQyxVQUFBSixJQVdBLFFBQUFLLEdBQUE1RSxHQUNBLE1BQUEwRSxNQUFBRyxNQUFBTCxhQUFBTSxRQUFBOUUsSUEzR0EsR0FBQXlCLElBQ0FzRCxlQUFBdEIsRUFDQXVCLGVBQUFsQixFQUNBbUIsZUFBQWIsRUFDQWMsb0JBQUFiLEVBQ0FjLGdCQUFBYixFQUNBYyxnQkFBQVIsRUFHQSxPQUFBbkQsR0FyQkE3RCxRQUNBQyxPQUFBLFNBQ0FDLFFBQUEsUUFBQUkiLCJmaWxlIjoic2VydmljZXMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaGlzIGlzIGluc3BpcmVkIGJ5L3JpcHBlZCBvZmYgZnJvbSB2YXJpb3VzIGJpdHMgb2YgTG92ZUZpZWxkIGRlbW8gY29kZTpcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGVzYW1wbGVzL2lvMjAxNS1jb2RlbGFicy9ibG9iL21hc3Rlci9sb3ZlZmllbGQvc3JjL2ZpbmFsL2xvdmVmaWVsZF9zZXJ2aWNlLmpzXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kZW1vcy9vbHltcGlhX2RiL2FuZ3VsYXIvZGVtby5qc1xuICogVGhhbmsgeW91IVxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdqc2RheScpXG4gICAgICAgIC5mYWN0b3J5KCdkYlNlcnZpY2UnLCBkYlNlcnZpY2UpO1xuXG4gICAgZGJTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywgJyRsb2cnLCAnJHEnLCAnJHJvb3RTY29wZScsICdUQUJMRSddO1xuXG4gICAgZnVuY3Rpb24gZGJTZXJ2aWNlKCRodHRwLCAkbG9nLCAkcSwgJHJvb3RTY29wZSwgVEFCTEUpIHtcbiAgICAgICAgdmFyIGRiXyA9IG51bGw7XG4gICAgICAgIHZhciBub3RlVGFibGVfID0gbnVsbDtcbiAgICAgICAgdmFyIGlzQ29ubmVjdGluZ18gPSBmYWxzZTtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGRiXzogZGJfLFxuICAgICAgICAgICAgbm90ZVRhYmxlXzogbm90ZVRhYmxlXyxcblxuICAgICAgICAgICAgY29ubmVjdDogY29ubmVjdCxcbiAgICAgICAgICAgIGluaXREYXRhYmFzZTogaW5pdERhdGFiYXNlXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdGlhbGl6ZXMgYSBkYXRhYmFzZSBjb25uZWN0aW9uLlxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlfSAtIHByb21pc2UgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgZGJfIGFuZCBub3RlVGFibGVfIHByb3BlcnRpZXMgaGF2ZSBoYWQgdmFsdWVzIGFzc2lnbmVkIHRvIHRoZW1cbiAgICAgICAgICpcbiAgICAgICAgICogTk9URTogMjAxNS8xMC8xMFxuICAgICAgICAgKiAgICAgICBXaGVuIG5vIGNvbm5lY3Rpb24gb3B0aW9ucyBhcmUgc2V0IExvdmVGaWVsZCBkb2VzIHNvbWUgZmVhdHVyZSBkZXRlY3Rpb24gdG8gZGV0ZXJtaW5lIHdoaWNoIGJhY2tpbmcgc3RvcmUgdG8gdXNlLlxuICAgICAgICAgKiAgICAgICBJZiB0aGUgYnJvd3NlciBzdXBwb3J0cyBJbmRleGVkRGIgaXQgdXNlcyB0aGF0LCB0aGVuIGZhbGxzIGJhY2sgdG8gV2ViU3FsIGFuZCBmaW5hbGx5IHRvIGFuIFwiaW4gbWVtb3J5XCIgZGF0YSBzdG9yZS5cbiAgICAgICAgICogICAgICAgSSBmb3VuZCB3aGVuIGRlYnVnZ2luZyBvbiBhY3R1YWwgZGV2aWNlcyB0aGF0IExvdmVGaWVsZCBjaG9zZSB0aGUgaW4gbWVtb3J5IChsZi5zY2hlbWEuRGF0YVN0b3JlVHlwZS5NRU1PUlkpIHN0b3JlXG4gICAgICAgICAqICAgICAgIG9uIGlPUyB3aGljaCBkaWRuJ3Qgd29yayBzbyB3ZWxsIHNvIGhlcmUgd2UgZW5zdXJlIFdlYlNxbCBpcyB1c2VkIGZvciBpT1MgYW5kIEFuZHJvaWQgZGV2aWNlcy5cbiAgICAgICAgICogICAgICAgSW5kZXhlZERiIHNlZW1lZCB0byB3b3JrIHdlbGwgb24gZGVza3RvcCBicm93c2Vycy5cbiAgICAgICAgICogICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9sb3ZlZmllbGQvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjLzAzX2xpZmVfb2ZfZGIubWQjMzExLWNvbm5lY3Qtb3B0aW9uc1xuICAgICAgICAgKiAgICAgICBodHRwczovL2NvcmRvdmEuYXBhY2hlLm9yZy9kb2NzL2VuLzUuMS4xL2NvcmRvdmEvc3RvcmFnZS9zdG9yYWdlLmh0bWxcbiAgICAgICAgICogICAgICAgaHR0cDovL2Nhbml1c2UuY29tLyNmZWF0PWluZGV4ZWRkYlxuICAgICAgICAgKiAgICAgICBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL2RkLzAyX2RhdGFfc3RvcmUubWQjMjUtd2Vic3FsLXN0b3JlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBjb25uZWN0KCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgY29uc29sZS5pbmZvKCdjb25uZWN0KCkgaXNDb25uZWN0aW5nXycsIGlzQ29ubmVjdGluZ18pO1xuXG4gICAgICAgICAgICBpZiAoaXNDb25uZWN0aW5nXyA9PT0gZmFsc2UpIHtcblxuICAgICAgICAgICAgICAgIHZhciBjb25uZWN0aW9uT3B0aW9ucyA9IHtzdG9yZVR5cGU6IGxmLnNjaGVtYS5EYXRhU3RvcmVUeXBlLklOREVYRURfREJ9O1xuICAgICAgICAgICAgICAgIGlmIChpb25pYy5QbGF0Zm9ybS5pc0lPUygpIHx8IGlvbmljLlBsYXRmb3JtLmlzQW5kcm9pZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25PcHRpb25zID0ge3N0b3JlVHlwZTogbGYuc2NoZW1hLkRhdGFTdG9yZVR5cGUuV0VCX1NRTH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHNlcnZpY2UuZGJfID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzQ29ubmVjdGluZ18gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBidWlsZFNjaGVtYSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY29ubmVjdChjb25uZWN0aW9uT3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YWJhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDb25uZWN0aW5nXyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlLmRiXyA9IGRhdGFiYXNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlLm5vdGVUYWJsZV8gPSBzZXJ2aWNlLmRiXy5nZXRTY2hlbWEoKS50YWJsZShUQUJMRS5Ob3RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmRiID0gZGF0YWJhc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCdTdGlsbCBjb25uZWN0aW5nIHRvIHRoZSBkYXRhYmFzZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENoZWNrcyBpZiBhbnkgZGF0YSBleGlzdHMgaW4gdGhlIERCLlxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlLjwhYm9vbGVhbj59XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBjaGVja0ZvckV4aXN0aW5nRGF0YSgpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIHNlcnZpY2UuZGJfLnNlbGVjdCgpLmZyb20oc2VydmljZS5ub3RlVGFibGVfKS5leGVjKCkudGhlbihcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAocm93cykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJvd3MubGVuZ3RoID4gMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5zZXJ0cyBzZWVkIGRhdGEgaW50byB0aGUgREIuXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2V9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICAvKmZ1bmN0aW9uIGluc2VydFNlZWREYXRhKCkge1xuICAgICAgICAgICAgJGxvZy5kZWJ1ZygnUG9wdWxhdGluZyBpbml0aWFsIE5vdGUgZGF0YScpO1xuXG4gICAgICAgICAgICB2YXIgdXJsID0gXCIuLi9qcy9kYXRhL25vdGVzLmpzb25cIjtcbiAgICAgICAgICAgIGlmIChpb25pYy5QbGF0Zm9ybS5pc0FuZHJvaWQoKSkge1xuICAgICAgICAgICAgICAgIHVybCA9IFwiL2FuZHJvaWRfYXNzZXQvd3d3L2pzL2RhdGEvbm90ZXMuanNvblwiO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpb25pYy5QbGF0Zm9ybS5pc0lPUygpKSB7XG4gICAgICAgICAgICAgICAgdXJsID0gXCJqcy9kYXRhL25vdGVzLmpzb25cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCh1cmwpLnRoZW4oXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3dzID0gcmVzcG9uc2UuZGF0YS5tYXAoZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2Uubm90ZVRhYmxlXy5jcmVhdGVSb3cob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuZGJfLmluc2VydCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaW50byhzZXJ2aWNlLm5vdGVUYWJsZV8pXG4gICAgICAgICAgICAgICAgICAgICAgICAudmFsdWVzKHJvd3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZXhlYygpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0qL1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJ1aWxkcyB0aGUgZGF0YWJhc2Ugc2NoZW1hLlxuICAgICAgICAgKiBAcmV0dXJuIHshbGYuc2NoZW1hLkJ1aWxkZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIFRPRE86IHRoaXMgaXMgd2hlcmUgeW91IHdvdWxkIGRlZmluZSB5b3VyIGRhdGFiYXNlIHRhYmxlc1xuICAgICAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL3NwZWMvMDFfc2NoZW1hLm1kXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBidWlsZFNjaGVtYSgpIHtcbiAgICAgICAgICAgIHZhciBzY2hlbWFCdWlsZGVyID0gbGYuc2NoZW1hLmNyZWF0ZSgnanNkYXktbm90YXMnLCAxKTtcbiAgICAgICAgICAgIHNjaGVtYUJ1aWxkZXJcbiAgICAgICAgICAgICAgICAuY3JlYXRlVGFibGUoVEFCTEUuTm90ZSlcbiAgICAgICAgICAgICAgICAuYWRkQ29sdW1uKCdpZCcsIGxmLlR5cGUuSU5URUdFUilcbiAgICAgICAgICAgICAgICAuYWRkQ29sdW1uKCdwYWxlc3RyYScsIGxmLlR5cGUuU1RSSU5HKVxuICAgICAgICAgICAgICAgIC5hZGRDb2x1bW4oJ3RleHQnLCBsZi5UeXBlLlNUUklORylcbiAgICAgICAgICAgICAgICAuYWRkUHJpbWFyeUtleShbJ2lkJ10pXG4gICAgICAgICAgICAgICAgLmFkZEluZGV4KCdpZHhfcGFsZXN0cmEnLCBbJ3BhbGVzdHJhJ10pO1xuICAgICAgICAgICAgcmV0dXJuIHNjaGVtYUJ1aWxkZXI7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb25uZWN0cyB0byBhbmQgc2VlZHMgdGhlIGRhdGFiYXNlIHdpdGggc29tZSBkdW1teSBkYXRhIGlmIG5vIGRhdGEgZXhpc3RzLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gaW5pdERhdGFiYXNlKCkge1xuICAgICAgICAgICAgJGxvZy5kZWJ1ZygnQXR0ZW1wdCB0byBjb25uZWN0IHRvIGFuZCBzZWVkIHRoZSBkYXRhYmFzZScpO1xuICAgICAgICAgICAgY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG92ZWZpZWxkLXN0YXJ0ZXItZXZlbnQ6ZGJDb25uZWN0ZWQnKTtcbiAgICAgICAgICAgICAgICBjaGVja0ZvckV4aXN0aW5nRGF0YSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhRXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKmlmIChkYXRhRXhpc3RzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydFNlZWREYXRhKCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb3ZlZmllbGQtc3RhcnRlci1ldmVudDpzZWVkRGF0YUluc2VydGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24gU2VydmnDp29hIGRlIGFic3RyYcOnw6NvIGRvIEZpcmViYXNlXG4gICAgICogQGF1dGhvciBXYWx0ZXIgR2FuZGFyZWxsYSA8d2FsdGVyLndnYm5AZ21haWwuY29tPlxuICAgICAqIEBtZW1iZXJvZiBqc2RheVxuICAgICAqIEB2ZXJzaW9uIDEuMC4wXG4gICAgICovXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdqc2RheScpXG4gICAgICAgIC5mYWN0b3J5KCdmaXJlU2VydmljZScsIGZpcmVTZXJ2aWNlKTtcblxuICAgIGZpcmVTZXJ2aWNlLiRpbmplY3QgPSBbJyRmaXJlYmFzZUFycmF5JywgJ1V0aWxzJywgJyRpb25pY0xvYWRpbmcnLCAnJGlvbmljUG9wdXAnXTtcblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXJvZiBqc2RheVxuICAgICAqIEBuZ2RvYyBmYWN0b3J5XG4gICAgICogQG5hbWUgZmlyZVNlcnZpY2VcbiAgICAgKiBAcGFyYW0ge3Byb3ZpZGVyfSAkZmlyZWJhc2VBcnJheSBBYnN0cmHDp8OjbyBkbyBGaXJlYmFzZSBBcnJheVxuICAgICAqIEBwYXJhbSB7ZmFjdG9yeX0gVXRpbHMgQ29uanVudG8gZGUgZnVuw6fDtWVzIGRlIHV0aWxpZGFkZVxuICAgICAqIEBwYXJhbSB7cHJvdmlkZXJ9ICRpb25pY0xvYWRpbmcgUHJvdmlkZXIgcGFyYSBsb2FkZXIgZGlyZWN0aXZlXG4gICAgICogQHBhcmFtIHtwcm92aWRlcn0gJGlvbmljUG9wdXAgcHJvdmlkZXIgcGFyYSBwb3B1cCBkaXJlY3RpdmVcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiAgIE1hbmlwdWxhIG9zIGRhZG9zIGUgZmF6IG8gYWNlc3NvIMOhIGJhc2UgZG8gRmlyZWJhc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaXJlU2VydmljZSAoJGZpcmViYXNlQXJyYXksIFV0aWxzLCAkaW9uaWNMb2FkaW5nLCAkaW9uaWNQb3B1cCkge1xuICAgICAgICAvLyBJbml0aWFsaXplIEZpcmViYXNlXG4gICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICBhcGlLZXk6IFwiQUl6YVN5QmRZTndRb2xsS2N5RjZoUWFKQ2ZzVndLQTBfR01pOVljXCIsXG4gICAgICAgICAgICBhdXRoRG9tYWluOiBcImpzZGF5LWFwcC5maXJlYmFzZWFwcC5jb21cIixcbiAgICAgICAgICAgIGRhdGFiYXNlVVJMOiBcImh0dHBzOi8vanNkYXktYXBwLmZpcmViYXNlaW8uY29tXCIsXG4gICAgICAgICAgICBzdG9yYWdlQnVja2V0OiBcImpzZGF5LWFwcC5hcHBzcG90LmNvbVwiXG4gICAgICAgIH07XG4gICAgICAgIHZhciBmYkluaXQgPSBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGNvbmZpZyk7XG5cbiAgICAgICAgdmFyIGRiID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoKTtcbiAgICAgICAgdmFyIHRyaWxoYXMgPSAkZmlyZWJhc2VBcnJheShkYi5jaGlsZCgndHJpbGhhcycpLm9yZGVyQnlDaGlsZCgndGltZXN0YW1wJykpO1xuICAgICAgICB2YXIgc3luYyA9ICRmaXJlYmFzZUFycmF5KGRiLmNoaWxkKCdwYWxlc3RyYXMnKS5vcmRlckJ5Q2hpbGQoJ2hvcmEnKSk7XG5cbiAgICAgICAgdmFyIF9yZXR1cm4gPSB7XG4gICAgICAgICAgICBnZXRUcmlsaGFzOiAgICAgX2dldFRyaWxoYXMsXG4gICAgICAgICAgICBnZXRUcmlsaGEgOiAgICAgX2dldFRyaWxoYSxcbiAgICAgICAgICAgIGdldFBhbGVzdHJhczogICBfZ2V0UGFsZXN0cmFzLFxuICAgICAgICAgICAgZ2V0UGFsZXN0cmE6ICAgIF9nZXRQYWxlc3RyYSxcbiAgICAgICAgICAgIGdldENvbWVudGFyaW9zOiBfZ2V0Q29tZW50YXJpb3MsXG4gICAgICAgICAgICBhZGRQYWxlc3RyYTogICAgX2FkZFBhbGVzdHJhLFxuICAgICAgICAgICAgYWRkQ29tZW50YXJpbzogIF9hZGRDb21lbnRhcmlvLFxuICAgICAgICAgICAgdXBkYXRlUGFsZXN0cmE6IF91cGRhdGVQYWxlc3RyYVxuICAgICAgICB9O1xuXG4gICAgICAgIF9sb2FkaW5nKCk7XG5cbiAgICAgICAgcmV0dXJuIF9yZXR1cm47XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEVzY3V0YSBvIGNhcnJlZ2FtZW50byBpbmljaWFsIGRvIGFycmF5IHZpbmRvIGRvIEZpcmViYXNlIGV4aWJpbmRvIHVtIGlvbmljTG9hZGVyXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2xvYWRpbmdcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9sb2FkaW5nICgpIHtcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuc2hvdyh7dGVtcGxhdGU6ICdDYXJyZWdhbmRvLi4uJ30pO1xuICAgICAgICAgICAgc3luYy4kbG9hZGVkKGZ1bmN0aW9uIChvaykge1xuICAgICAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm8pIHtcbiAgICAgICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnT3BzIScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjtcIj5Ow6NvIGZvaSBwb3Nzw612ZWwgY2FycmVnYXIgb3MgZGFkb3MuPGJyPlZlcmlmaXF1ZSBzdWEgY29uZXjDo28uPC9kaXY+JyxcbiAgICAgICAgICAgICAgICAgICAgb2tUeXBlOiAnYnV0dG9uLWVuZXJnaXplZCdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJldG9ybmEgYSBsaXN0YSBkZSBwYWxlc3RyYXMgdmluZGEgZG8gZmlyZWJhc2VcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfZ2V0UGFsZXN0cmFzXG4gICAgICAgICAqIEByZXR1cm5zIHtBcnJheX0gICAgICAgICBMaXN0YSBkZSBwYWxlc3RyYXNcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9nZXRQYWxlc3RyYXMgKCkge1xuICAgICAgICAgICAgcmV0dXJuIHN5bmM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0b3JuYSBhIGxpc3RhIGRlIHRyaWxoYXMgdmluZGEgZG8gZmlyZWJhc2VcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfZ2V0VHJpbGhhc1xuICAgICAgICAgKiBAcmV0dXJucyB7QXJyYXl9ICAgICAgICAgTGlzdGEgZGUgcGFsZXN0cmFzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0VHJpbGhhcyAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJpbGhhcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXRvcm5hIHVtYSB0cmlsaGEgcGFzc2FuZG8tc2UgbyAkaWRcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfZ2V0VHJpbGhhXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBfaWRcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9nZXRUcmlsaGEgKF9pZCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0cmlsaGFzLmZvckVhY2goZnVuY3Rpb24gKF90KSB7XG4gICAgICAgICAgICAgICAgaWYgKF90LiRpZCA9PSBfaWQpXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF90O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0b3JuYSB1bWEgcGFsZXN0cmEgZGEgbGlzdGFcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfZ2V0UGFsZXN0cmFcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IF9rZXkgICAgIEEga2V5IGRhIHBhbGVzdHJhIG5vIGFycmF5XG4gICAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9ICAgICAgICBBIHBhbGVzdHJhIGVuY29udHJhZGFcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9nZXRQYWxlc3RyYSAoX2tleSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG5cbiAgICAgICAgICAgIHN5bmMuZm9yRWFjaChmdW5jdGlvbiAoX3ZhbCkge1xuICAgICAgICAgICAgICAgIGlmIChfdmFsLiRpZCA9PSBfa2V5KVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBfdmFsO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRpY2lvbmEgdW0gb2JqZXRvIHBhbGVzdHJhIMOgIGxpc3RhXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2FkZFBhbGVzdHJhXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBfcGFsZXN0cmEgICAgT2JqZXRvIHJlcHJlc2VudGFuZG8gdW1hIHBhbGVzdHJhXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfYWRkUGFsZXN0cmEgKF9wYWxlc3RyYSkge1xuICAgICAgICAgICAgc3luYy4kYWRkKF9wYWxlc3RyYSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQXR1YWxpemEgdW0gaXRlbSBkbyBvYmpldG8gcGFsZXN0cmFcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfdXBkYXRlUGFsZXN0cmFcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IF9wYWxlc3RyYSAgICBPYmpldG8gcmVwcmVzZW50YW5kbyB1bWEgcGFsZXN0cmFcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IF9pdGVtICAgICAgICBDaGF2ZSBkbyBpdGVtIGEgc2VyIGF0dWFsaXphZG9cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF91cGRhdGVQYWxlc3RyYSAoX3BhbGVzdHJhLCBfaXRlbSkge1xuICAgICAgICAgICAgZGIuY2hpbGQoJ3BhbGVzdHJhcycpLmNoaWxkKF9wYWxlc3RyYS4kaWQpLmNoaWxkKF9pdGVtKS5zZXQoX3BhbGVzdHJhW19pdGVtXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRpY2lvbmEgdW0gY29tZW50w6FyaW8gw6AgcGFsZXN0cmFcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfYWRkQ29tZW50YXJpb1xuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gX3BhbGVzdHJhICAgIEEgcGFsZXN0cmEgYSBzZXIgYWRpY2lvbmFkYSBvIGNvbWVudMOhcmlvXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBfY29tZW50YXJpbyAgTyBjb21lbnTDoXJpb1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX2FkZENvbWVudGFyaW8gKF9wYWxlc3RyYSwgX2NvbWVudGFyaW8pIHtcbiAgICAgICAgICAgIHZhciBfZHQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICBfY29tZW50YXJpby5yZWdpc3RybyA9IF9kdC5nZXRUaW1lKCk7XG4gICAgICAgICAgICBfcGFsZXN0cmEuY29tZW50YXJpb3MgPSBfcGFsZXN0cmEuY29tZW50YXJpb3MgfHwge307XG4gICAgICAgICAgICBfcGFsZXN0cmEuY29tZW50YXJpb3NbX2R0LmdldFRpbWUoKS50b1N0cmluZygpXSA9IF9jb21lbnRhcmlvO1xuXG4gICAgICAgICAgICBkYi5jaGlsZCgncGFsZXN0cmFzJykuY2hpbGQoX3BhbGVzdHJhLiRpZCkuY2hpbGQoXCJjb21lbnRhcmlvc1wiKS5jaGlsZChfZHQuZ2V0VGltZSgpLnRvU3RyaW5nKCkpLnNldChfY29tZW50YXJpbyk7XG4gICAgICAgICAgICByZXR1cm4gX2dldENvbWVudGFyaW9zKF9wYWxlc3RyYSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogTGlzdGEgb3MgY29tZW50YXJpb3MgZGUgdW1hIHBhbGVzdHJhXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2dldENvbWVudGFyaW9zXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwYWxlc3RyYVxuICAgICAgICAgKiBAcmV0dXJucyB7QXJyYXl9IExpc3RhIGRlIGNvbWVudGFyaW9zXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0Q29tZW50YXJpb3MgKF9wYWxlc3RyYSkge1xuICAgICAgICAgICAgaWYgKCFfcGFsZXN0cmEuY29tZW50YXJpb3MpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuXG4gICAgICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhfcGFsZXN0cmEuY29tZW50YXJpb3MpLmZvckVhY2goZnVuY3Rpb24oX2tleSl7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goX3BhbGVzdHJhLmNvbWVudGFyaW9zW19rZXldKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnanNkYXknKVxuICAgICAgICAuZmFjdG9yeSgnbm90ZVNlcnZpY2UnLCBub3RlU2VydmljZSk7XG5cbiAgICBub3RlU2VydmljZS4kaW5qZWN0ID0gWyckbG9nJywgJyRxJywgJ2RiU2VydmljZSddO1xuXG4gICAgZnVuY3Rpb24gbm90ZVNlcnZpY2UoJGxvZywgJHEsIGRiU2VydmljZSkge1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgYWRkOiBhZGQsXG4gICAgICAgICAgICBlZGl0OiBlZGl0LFxuICAgICAgICAgICAgZ2V0QWxsOiBnZXRBbGwsXG4gICAgICAgICAgICBnZXRCeUlkOiBnZXRCeUlkLFxuICAgICAgICAgICAgZ2V0QnlQYWxlc3RyYTogZ2V0QnlQYWxlc3RyYSxcbiAgICAgICAgICAgIHJlbW92ZTogcmVtb3ZlXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vXG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkcyBhIG5ldyBub3RlIHRvIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IC0gdGhlIHRleHQgb2YgdGhlIG5vdGUgdG8gdXBkYXRlXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2V9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBhZGQocGFsZXN0cmEsIHRleHQpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGRiU2VydmljZS5jb25uZWN0KCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9ob2plID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgcm93ID0gZGJTZXJ2aWNlLm5vdGVUYWJsZV8uY3JlYXRlUm93KHtcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogX2hvamUuZ2V0VGltZSgpLFxuICAgICAgICAgICAgICAgICAgICAncGFsZXN0cmEnOiBwYWxlc3RyYSxcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQnOiB0ZXh0XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgZG9jczogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9sb3ZlZmllbGQvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjLzA0X3F1ZXJ5Lm1kIzQyLWluc2VydC1xdWVyeS1idWlsZGVyXG4gICAgICAgICAgICAgICAgZGJTZXJ2aWNlLmRiXy5pbnNlcnRPclJlcGxhY2UoKVxuICAgICAgICAgICAgICAgICAgICAuaW50byhkYlNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgLnZhbHVlcyhbcm93XSlcbiAgICAgICAgICAgICAgICAgICAgLmV4ZWMoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVwZGF0ZXMgYSBub3RlIGluIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtndWlkfSAtIHRoZSBpZCBvZiB0aGUgbm90ZSB0byB1cGRhdGVcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IC0gdGhlIHRleHQgb2YgdGhlIG5vdGUgdG8gdXBkYXRlXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2V9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBlZGl0KGlkLCB0ZXh0KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wNF9xdWVyeS5tZCM0My11cGRhdGUtcXVlcnktYnVpbGRlclxuICAgICAgICAgICAgICAgIGRiU2VydmljZS5kYl8udXBkYXRlKGRiU2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAuc2V0KGRiU2VydmljZS5ub3RlVGFibGVfLnRleHQsIHRleHQpXG4gICAgICAgICAgICAgICAgICAgIC53aGVyZShkYlNlcnZpY2Uubm90ZVRhYmxlXy5pZC5lcShpZCkpXG4gICAgICAgICAgICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXRzIGFsbCBub3RlcyBmcm9tIHRoZSAgZGIuXG4gICAgICAgICAqIEByZXR1cm4geyFhbmd1bGFyLiRxLlByb21pc2UuPCFBcnJheTwhT2JqZWN0Pj59XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRBbGwoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogT2JzZXJ2ZSB0aGUgc2VsZWN0IHF1ZXJ5IHRvIHNhdmUgaGF2aW5nIHRvIGV4cGxpY2l0bHkgY2FsbCBnZXROb3RlcygpIGFmdGVyIGFuIElOU0VSVC9VUERBVEUgb3IgREVMRVRFIGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wNF9xdWVyeS5tZCM0Ni1vYnNlcnZlcnNcbiAgICAgICAgICAgICAgICAvLyBkYi5vYnNlcnZlKHNlbGVjdFF1ZXJ5LCBoYW5kbGVyKTtcblxuICAgICAgICAgICAgICAgIC8vIFNFTEVDVCBkb2NzOiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL3NwZWMvMDRfcXVlcnkubWQjNDE4LXJldHJpZXZhbC1vZi1xdWVyeS1yZXN1bHRzXG4gICAgICAgICAgICAgICAgZGJTZXJ2aWNlLmRiXy5zZWxlY3QoKVxuICAgICAgICAgICAgICAgICAgICAuZnJvbShkYlNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgLmV4ZWMoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyb3dzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyb3dzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZDogJywgcmVhc29uKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldHMgYSBzaW5nbGUgbm90ZSBmcm9tIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtndWlkfSAtIHRoZSBpZCBvZiB0aGUgbm90ZSB0byByZXRyaWV2ZVxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlLjwhT2JqZWN0Pn1cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGdldEJ5SWQoaWQpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGRiU2VydmljZS5jb25uZWN0KCkudGhlbihmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBkYlNlcnZpY2UuZGJfLnNlbGVjdCgpXG4gICAgICAgICAgICAgICAgICAgIC5mcm9tKGRiU2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAud2hlcmUoZGJTZXJ2aWNlLm5vdGVUYWJsZV8uaWQuZXEoaWQpKVxuICAgICAgICAgICAgICAgICAgICAuZXhlYygpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQocmVzdWx0cykgJiYgcmVzdWx0cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9nLmVycm9yKCdOb3RlIG5vdCBmb3VuZCB3aXRoIGlkIG9mOiAnICsgaWQsIHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEJ5UGFsZXN0cmEocGFsZXN0cmEpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGRiU2VydmljZS5jb25uZWN0KCkudGhlbihmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBkYlNlcnZpY2UuZGJfLnNlbGVjdCgpXG4gICAgICAgICAgICAgICAgICAgIC5mcm9tKGRiU2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAud2hlcmUoZGJTZXJ2aWNlLm5vdGVUYWJsZV8ucGFsZXN0cmEuZXEocGFsZXN0cmEpKVxuICAgICAgICAgICAgICAgICAgICAuZXhlYygpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWxldGVzIGEgbm90ZSBmcm9tIHRoZSBkYi5cbiAgICAgICAgICogQHBhcmFtIHtndWlkfSAtIHRoZSBpZCBvZiB0aGUgbm90ZSB0byByZXRyaWV2ZVxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlfSAtIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCBvbmNlIHRoZSByb3cgaGFzIGJlZW4gZGVsZXRlZFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlKGlkKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy8gREVMRVRFIGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wNF9xdWVyeS5tZCM0NC1kZWxldGUtcXVlcnktYnVpbGRlclxuICAgICAgICAgICAgICAgIGRiU2VydmljZS5kYl8uZGVsZXRlKClcbiAgICAgICAgICAgICAgICAgICAgLmZyb20oZGJTZXJ2aWNlLm5vdGVUYWJsZV8pXG4gICAgICAgICAgICAgICAgICAgIC53aGVyZShkYlNlcnZpY2Uubm90ZVRhYmxlXy5pZC5lcShpZCkpXG4gICAgICAgICAgICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcmVhdGVzIGEgZ3VpZC5cbiAgICAgICAgICogQHJldHVybiB7Z3VpZH1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICogY29weS9wYXN0ZWQgZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMDUwNzQvMjY1MjkxMCAtIHRoYW5rIHlvdVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ3VpZCgpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHM0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuICAgICAgICAgICAgICAgICAgICAudG9TdHJpbmcoMTYpXG4gICAgICAgICAgICAgICAgICAgIC5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiBCaWJsaW90ZWNhIGRlIGZ1bsOnw7VlcyB1dGlsaXTDoXJpYXNcbiAgICAgKiBAYXV0aG9yIFdhbHRlciBHYW5kYXJlbGxhIDx3YWx0ZXIud2dibkBnbWFpbC5jb20+XG4gICAgICogQG1lbWJlcm9mIGpzZGF5XG4gICAgICogQHZlcnNpb24gMS4wLjBcbiAgICAgKi9cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2pzZGF5JylcbiAgICAgICAgLmZhY3RvcnkoJ1V0aWxzJywgVXRpbHMpO1xuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIGpzZGF5XG4gICAgICogQG5nZG9jIGZhY3RvcnlcbiAgICAgKiBAbmFtZSBVdGlsc1xuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqICAgUHJvdsOqIGZ1bsOnw7VlcyB1dGlsaXTDoXJpYXMgcGFyYSB1c28gZGEgYXBsaWNhw6fDo29cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBVdGlscyAoKSB7XG4gICAgICAgIHZhciBfcmV0dXJuID0ge1xuICAgICAgICAgICAgcGFyc2VTdHJUb0RhdGU6ICAgICAgICAgX3BhcnNlU3RyVG9EYXRlLFxuICAgICAgICAgICAgcGFyc2VEYXRlVG9TdHI6ICAgICAgICAgX3BhcnNlRGF0ZVRvU3RyLFxuICAgICAgICAgICAgcGFyc2VUaW1lVG9TdHI6ICAgICAgICAgX3BhcnNlVGltZVRvU3RyLFxuICAgICAgICAgICAgcGFyc2VTaG9ydERhdGVUb1N0cjogICAgX3BhcnNlU2hvcnREYXRlVG9TdHIsXG4gICAgICAgICAgICBzZXRMb2NhbFN0b3JhZ2U6ICAgICAgICBfc2V0TG9jYWxTdG9yYWdlLFxuICAgICAgICAgICAgZ2V0TG9jYWxTdG9yYWdlOiAgICAgICAgX2dldExvY2FsU3RvcmFnZVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBfcmV0dXJuO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmFuc2Zvcm1hIHVtYSBzdHJpbmcgZm9ybWF0YWRhIGNvbW8gZGQvbW0veXl5eSBwYXJhIHVtIG9iamV0byBEYXRlXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX3BhcnNlU3RyVG9EYXRlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBfZGF0ZSAgICAgICAgRGF0YSBubyBmb3JtYXRvIGRkL21tL3l5eXlcbiAgICAgICAgICogQHBhcmFtIHtCb29sZWFufSBfdGltZSAgICAgICBCb29sZWFubyBzZSBkZXZlIHNlciBjb25zaWRlcmFkbyBhIGhvcmFcbiAgICAgICAgICogQHJldHVybnMge251bWJlcn0gICAgICAgICAgICBUaW1lc3RhbXAgZGEgZGF0YVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX3BhcnNlU3RyVG9EYXRlIChfZGF0ZSwgX3RpbWUpIHtcbiAgICAgICAgICAgIF90aW1lID0gX3RpbWUgfHwgZmFsc2U7XG4gICAgICAgICAgICB2YXIgX2RhdGUgPSBfZGF0ZS5zcGxpdCgnICcpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKFxuICAgICAgICAgICAgICAgIF9kYXRlWzBdLnNwbGl0KCcvJylbMl0sXG4gICAgICAgICAgICAgICAgcGFyc2VJbnQoX2RhdGVbMF0uc3BsaXQoJy8nKVsxXSkgLSAxLFxuICAgICAgICAgICAgICAgIF9kYXRlWzBdLnNwbGl0KCcvJylbMF0sXG4gICAgICAgICAgICAgICAgX3RpbWUgPyBfZGF0ZVsxXS5zcGxpdCgnOicpWzBdIDogMCxcbiAgICAgICAgICAgICAgICBfdGltZSA/IF9kYXRlWzFdLnNwbGl0KCc6JylbMV0gOiAwLFxuICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgMFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZ2V0VGltZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYW5zZm9ybWEgdW0gdGltZXN0YW1wIHBhcmEgZGF0YSBubyBmb3JtYXRvIGRkL21tL3l5eXkgW2hoOm1tXVxuICAgICAgICAgKiBAbWVtYmVyb2YgVXRpbHNcbiAgICAgICAgICogQGZ1bmN0aW9uIF9wYXJzZURhdGVUb1N0clxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gX2RhdGUgICAgICAgIFRpbWVzdGFtcCBkYSBkYXRhXG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gX3RpbWUgICAgICAgQm9vbGVhbm8gc2UgZGV2ZSBzZXIgY29uc2lkZXJhZG8gYSBob3JhXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9ICAgICAgICAgICAgQSBkYXRhIG5vIGZvcm1hdG8gZGQvbW0veXl5eSBbaGg6bW1dXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfcGFyc2VEYXRlVG9TdHIgKF9kYXRlLCBfdGltZSl7XG4gICAgICAgICAgICBfdGltZSA9IF90aW1lIHx8IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKF9kYXRlKTtcbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0LmdldERhdGUoKSA8IDEwID8gXCIwXCIrcmVzdWx0LmdldERhdGUoKSA6IHJlc3VsdC5nZXREYXRlKCkpXG4gICAgICAgICAgICAgICAgK1wiL1wiXG4gICAgICAgICAgICAgICAgKyhyZXN1bHQuZ2V0TW9udGgoKSsxIDwgMTAgPyBcIjBcIisocmVzdWx0LmdldE1vbnRoKCkrMSkgOiByZXN1bHQuZ2V0TW9udGgoKSsxKVxuICAgICAgICAgICAgICAgICtcIi9cIityZXN1bHQuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgKyhfdGltZSA/IFwiIFwiK3Jlc3VsdC5nZXRIb3VycygpLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICArXCI6XCJcbiAgICAgICAgICAgICAgICArcmVzdWx0LmdldE1pbnV0ZXMoKS50b1N0cmluZygpIDogXCJcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVHJhbnNmb3JtYSB1bSB0aW1lc3RhbXAgZW0gaG9yYSBubyBmb3JtYXRvIGhoOm1tXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX3BhcnNlVGltZVRvU3RyXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBfZGF0ZSAgICAgICAgVGltZXN0YW1wIGRhIGRhdGFcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ30gICAgICAgICAgICBBIGhvcmEgbm8gZm9ybWF0byBoaDptbVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX3BhcnNlVGltZVRvU3RyIChfZGF0ZSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKF9kYXRlKTtcbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0LmdldEhvdXJzKCkgPCAxMCA/ICcwJyArIHJlc3VsdC5nZXRIb3VycygpIDogcmVzdWx0LmdldEhvdXJzKCkpXG4gICAgICAgICAgICAgICAgK1wiOlwiXG4gICAgICAgICAgICAgICAgKyhyZXN1bHQuZ2V0TWludXRlcygpIDwgMTAgPyAnMCcgKyByZXN1bHQuZ2V0TWludXRlcygpIDogcmVzdWx0LmdldE1pbnV0ZXMoKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVHJhbnNmb3JtYSB1bSB0aW1lc3RhbXAgbnVtYSBkYXRhIGN1cnRhIG5vIGZvcm1hdG8gZGQvbW1cbiAgICAgICAgICogQG1lbWJlcm9mIFV0aWxzXG4gICAgICAgICAqIEBmdW5jdGlvbiBfcGFyc2VTaG9ydERhdGVUb1N0clxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gX2RhdGUgICAgICAgIFRpbWVzdGFtcCBkYSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9ICAgICAgICAgICAgQSBkYXRhIG5vIGZvcm1hdG8gZGQvbW1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9wYXJzZVNob3J0RGF0ZVRvU3RyIChfZGF0ZSl7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IERhdGUoX2RhdGUpO1xuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQuZ2V0RGF0ZSgpIDwgMTAgPyBcIjBcIityZXN1bHQuZ2V0RGF0ZSgpIDogcmVzdWx0LmdldERhdGUoKSlcbiAgICAgICAgICAgICAgICArXCIvXCJcbiAgICAgICAgICAgICAgICArKHJlc3VsdC5nZXRNb250aCgpKzEgPCAxMCA/IFwiMFwiKyhyZXN1bHQuZ2V0TW9udGgoKSsxKSA6IHJlc3VsdC5nZXRNb250aCgpKzEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNhbHZhIHVtIGl0ZW0gbm8gbG9jYWxTdG9yYWdlIGRvIGRpc3Bvc2l0aXZvXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX3NldExvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2l0ZW0gICAgIENoYXZlIGRlIGlkZW50aWZpY2HDp8OjbyBkbyBpdGVtIG5vIGxvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gX3ZhbG9yICAgIFZhbG9yIGRvIGl0ZW1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9zZXRMb2NhbFN0b3JhZ2UgKF9pdGVtLCBfdmFsb3IpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKF9pdGVtLCBKU09OLnN0cmluZ2lmeShfdmFsb3IpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXNnYXRhIHVtIGl0ZW0gc2Fsdm8gbm8gbG9jYWxTdG9yYWdlXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX2dldExvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2l0ZW0gICAgIENoYXZlIGRlIGlkZW50aWZpY2HDp8OjbyBkbyBpdGVtIG5vIGxvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSAgICAgICAgIEl0ZW0gZG8gbG9jYWxTdG9yYWdlXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0TG9jYWxTdG9yYWdlIChfaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oX2l0ZW0pKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
