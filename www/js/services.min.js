!function(){"use strict";function e(e,t,n,o,r){function a(){var e=n.defer();if(console.info("connect() isConnecting_",d),d===!1){var t={storeType:lf.schema.DataStoreType.INDEXED_DB};(ionic.Platform.isIOS()||ionic.Platform.isAndroid())&&(t={storeType:lf.schema.DataStoreType.WEB_SQL}),null===f.db_?(d=!0,c().connect(t).then(function(t){d=!1,f.db_=t,f.noteTable_=f.db_.getSchema().table(r.Note),window.db=t,e.resolve()})):e.resolve()}else e.reject("Still connecting to the database");return e.promise}function i(){var e=n.defer();return f.db_.select().from(f.noteTable_).exec().then(function(t){e.resolve(t.length>0)}),e.promise}function c(){var e=lf.schema.create("jsday-notas",1);return e.createTable(r.Note).addColumn("id",lf.Type.INTEGER).addColumn("palestra",lf.Type.STRING).addColumn("text",lf.Type.STRING).addPrimaryKey(["id"]).addIndex("idx_palestra",["palestra"]),e}function s(){t.debug("Attempt to connect to and seed the database"),a().then(function(){o.$broadcast("lovefield-starter-event:dbConnected"),i().then(function(e){})})}var l=null,u=null,d=!1,f={db_:l,noteTable_:u,connect:a,initDatabase:s};return f}angular.module("jsday").factory("dbService",e),e.$inject=["$http","$log","$q","$rootScope","TABLE"]}(),function(){"use strict";function e(e,t,n,o,r){function a(){return _}function i(){o.show({template:"Carregando..."}),T.$loaded(function(e){o.hide()},function(e){o.hide(),r.alert({title:"Ops!",template:'<div style="text-align: center;">Não foi possível carregar os dados.<br>Verifique sua conexão.</div>',okType:"button-energized"})})}function c(){return T}function s(){return v}function l(e){var t=!1;return v.forEach(function(n){n.$id==e&&(t=n)}),t}function u(e){var t=null;return T.forEach(function(n){n.$id==e&&(t=n)}),t}function d(e){T.$add(e)}function f(e,t){b.child("palestras").child(e.$id).child(t).set(e[t])}function p(e,t){var n=new Date;return t.registro=n.getTime(),e.comentarios=e.comentarios||{},e.comentarios[n.getTime().toString()]=t,b.child("palestras").child(e.$id).child("comentarios").child(n.getTime().toString()).set(t),g(e)}function g(e){if(!e.comentarios)return{};var t=[];return Object.keys(e.comentarios).forEach(function(n){t.push(e.comentarios[n])}),t}function h(){return y}var m={apiKey:"AIzaSyBdYNwQollKcyF6hQaJCfsVwKA0_GMi9Yc",authDomain:"jsday-app.firebaseapp.com",databaseURL:"https://jsday-app.firebaseio.com",storageBucket:"jsday-app.appspot.com"},b=(firebase.initializeApp(m),firebase.database().ref()),v=e(b.child("trilhas").orderByChild("timestamp")),T=e(b.child("palestras").orderByChild("hora")),y=e(b.child("workshops")),_=t(b.child("appConfig")),S={getAppConfig:a,getTrilhas:s,getTrilha:l,getPalestras:c,getPalestra:u,getComentarios:g,getWorkshops:h,addPalestra:d,addComentario:p,updatePalestra:f};return i(),S}angular.module("jsday").factory("fireService",e),e.$inject=["$firebaseArray","$firebaseObject","Utils","$ionicLoading","$ionicPopup"]}(),function(){"use strict";function e(e,t,n){function o(e,o){var r=t.defer();return n.connect().then(function(){var t=new Date,a=n.noteTable_.createRow({id:t.getTime(),palestra:e,text:o});n.db_.insertOrReplace().into(n.noteTable_).values([a]).exec().then(function(){r.resolve()})}),r.promise}function r(e,o){var r=t.defer();return n.connect().then(function(){n.db_.update(n.noteTable_).set(n.noteTable_.text,o).where(n.noteTable_.id.eq(e)).exec().then(function(){r.resolve()})}),r.promise}function a(){var e=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).exec().then(function(t){e.resolve(t)})},function(e){console.error("Failed: ",e)}),e.promise}function i(o){var r=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).where(n.noteTable_.id.eq(o)).exec().then(function(t){angular.isDefined(t)&&1===t.length?r.resolve(t[0]):(e.error("Note not found with id of: "+o,t),r.reject())})}),r.promise}function c(e){var o=t.defer();return n.connect().then(function(){n.db_.select().from(n.noteTable_).where(n.noteTable_.palestra.eq(e)).exec().then(function(e){o.resolve(e)})}),o.promise}function s(e){var o=t.defer();return n.connect().then(function(){n.db_["delete"]().from(n.noteTable_).where(n.noteTable_.id.eq(e)).exec().then(function(){o.resolve()})}),o.promise}var l={add:o,edit:r,getAll:a,getById:i,getByPalestra:c,remove:s};return l}angular.module("jsday").factory("noteService",e),e.$inject=["$log","$q","dbService"]}(),function(){"use strict";function e(){function e(e,t){t=t||!1;var e=e.split(" "),n=new Date(e[0].split("/")[2],parseInt(e[0].split("/")[1])-1,e[0].split("/")[0],t?e[1].split(":")[0]:0,t?e[1].split(":")[1]:0,0,0);return n.getTime()}function t(e,t){t=t||!1;var n=new Date(e);return(n.getDate()<10?"0"+n.getDate():n.getDate())+"/"+(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"/"+n.getFullYear().toString()+(t?" "+n.getHours().toString()+":"+n.getMinutes().toString():"")}function n(e){var t=new Date(e);return(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}function o(e){var t=new Date(e);return(t.getDate()<10?"0"+t.getDate():t.getDate())+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)}function r(e,t){localStorage.setItem(e,JSON.stringify(t))}function a(e){return JSON.parse(localStorage.getItem(e))}var i={parseStrToDate:e,parseDateToStr:t,parseTimeToStr:n,parseShortDateToStr:o,setLocalStorage:r,getLocalStorage:a};return i}angular.module("jsday").factory("Utils",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRic2VydmljZS5qcyIsImZpcmViYXNlU2VydmljZS5qcyIsIm5vdGVzZXJ2aWNlLmpzIiwidXRpbHMuanMiXSwibmFtZXMiOlsiZGJTZXJ2aWNlIiwiJGh0dHAiLCIkbG9nIiwiJHEiLCIkcm9vdFNjb3BlIiwiVEFCTEUiLCJjb25uZWN0IiwiZGVmZXJyZWQiLCJkZWZlciIsImNvbnNvbGUiLCJpbmZvIiwiaXNDb25uZWN0aW5nXyIsImNvbm5lY3Rpb25PcHRpb25zIiwic3RvcmVUeXBlIiwibGYiLCJzY2hlbWEiLCJEYXRhU3RvcmVUeXBlIiwiSU5ERVhFRF9EQiIsImlvbmljIiwiUGxhdGZvcm0iLCJpc0lPUyIsImlzQW5kcm9pZCIsIldFQl9TUUwiLCJzZXJ2aWNlIiwiZGJfIiwiYnVpbGRTY2hlbWEiLCJ0aGVuIiwiZGF0YWJhc2UiLCJub3RlVGFibGVfIiwiZ2V0U2NoZW1hIiwidGFibGUiLCJOb3RlIiwid2luZG93IiwiZGIiLCJyZXNvbHZlIiwicmVqZWN0IiwicHJvbWlzZSIsImNoZWNrRm9yRXhpc3RpbmdEYXRhIiwic2VsZWN0IiwiZnJvbSIsImV4ZWMiLCJyb3dzIiwibGVuZ3RoIiwic2NoZW1hQnVpbGRlciIsImNyZWF0ZSIsImNyZWF0ZVRhYmxlIiwiYWRkQ29sdW1uIiwiVHlwZSIsIklOVEVHRVIiLCJTVFJJTkciLCJhZGRQcmltYXJ5S2V5IiwiYWRkSW5kZXgiLCJpbml0RGF0YWJhc2UiLCJkZWJ1ZyIsIiRicm9hZGNhc3QiLCJkYXRhRXhpc3RzIiwiYW5ndWxhciIsIm1vZHVsZSIsImZhY3RvcnkiLCIkaW5qZWN0IiwiZmlyZVNlcnZpY2UiLCIkZmlyZWJhc2VBcnJheSIsIiRmaXJlYmFzZU9iamVjdCIsIlV0aWxzIiwiJGlvbmljTG9hZGluZyIsIiRpb25pY1BvcHVwIiwiX2dldEFwcENvbmZpZyIsImFwcENvbmZpZyIsIl9sb2FkaW5nIiwic2hvdyIsInRlbXBsYXRlIiwic3luYyIsIiRsb2FkZWQiLCJvayIsImhpZGUiLCJlcnJvIiwiYWxlcnQiLCJ0aXRsZSIsIm9rVHlwZSIsIl9nZXRQYWxlc3RyYXMiLCJfZ2V0VHJpbGhhcyIsInRyaWxoYXMiLCJfZ2V0VHJpbGhhIiwiX2lkIiwicmVzdWx0IiwiZm9yRWFjaCIsIl90IiwiJGlkIiwiX2dldFBhbGVzdHJhIiwiX2tleSIsIl92YWwiLCJfYWRkUGFsZXN0cmEiLCJfcGFsZXN0cmEiLCIkYWRkIiwiX3VwZGF0ZVBhbGVzdHJhIiwiX2l0ZW0iLCJjaGlsZCIsInNldCIsIl9hZGRDb21lbnRhcmlvIiwiX2NvbWVudGFyaW8iLCJfZHQiLCJEYXRlIiwicmVnaXN0cm8iLCJnZXRUaW1lIiwiY29tZW50YXJpb3MiLCJ0b1N0cmluZyIsIl9nZXRDb21lbnRhcmlvcyIsInJlcyIsIk9iamVjdCIsImtleXMiLCJwdXNoIiwiX2dldFdvcmtzaG9wcyIsIndvcmtzaG9wcyIsImNvbmZpZyIsImFwaUtleSIsImF1dGhEb21haW4iLCJkYXRhYmFzZVVSTCIsInN0b3JhZ2VCdWNrZXQiLCJmaXJlYmFzZSIsImluaXRpYWxpemVBcHAiLCJyZWYiLCJvcmRlckJ5Q2hpbGQiLCJfcmV0dXJuIiwiZ2V0QXBwQ29uZmlnIiwiZ2V0VHJpbGhhcyIsImdldFRyaWxoYSIsImdldFBhbGVzdHJhcyIsImdldFBhbGVzdHJhIiwiZ2V0Q29tZW50YXJpb3MiLCJnZXRXb3Jrc2hvcHMiLCJhZGRQYWxlc3RyYSIsImFkZENvbWVudGFyaW8iLCJ1cGRhdGVQYWxlc3RyYSIsIm5vdGVTZXJ2aWNlIiwiYWRkIiwicGFsZXN0cmEiLCJ0ZXh0IiwiX2hvamUiLCJyb3ciLCJjcmVhdGVSb3ciLCJpZCIsImluc2VydE9yUmVwbGFjZSIsImludG8iLCJ2YWx1ZXMiLCJlZGl0IiwidXBkYXRlIiwid2hlcmUiLCJlcSIsImdldEFsbCIsInJlYXNvbiIsImVycm9yIiwiZ2V0QnlJZCIsInJlc3VsdHMiLCJpc0RlZmluZWQiLCJnZXRCeVBhbGVzdHJhIiwicmVtb3ZlIiwiX3BhcnNlU3RyVG9EYXRlIiwiX2RhdGUiLCJfdGltZSIsInNwbGl0IiwicGFyc2VJbnQiLCJfcGFyc2VEYXRlVG9TdHIiLCJnZXREYXRlIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsIl9wYXJzZVRpbWVUb1N0ciIsIl9wYXJzZVNob3J0RGF0ZVRvU3RyIiwiX3NldExvY2FsU3RvcmFnZSIsIl92YWxvciIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiX2dldExvY2FsU3RvcmFnZSIsInBhcnNlIiwiZ2V0SXRlbSIsInBhcnNlU3RyVG9EYXRlIiwicGFyc2VEYXRlVG9TdHIiLCJwYXJzZVRpbWVUb1N0ciIsInBhcnNlU2hvcnREYXRlVG9TdHIiLCJzZXRMb2NhbFN0b3JhZ2UiLCJnZXRMb2NhbFN0b3JhZ2UiXSwibWFwcGluZ3MiOiJDQU9BLFdBQ0EsWUFRQSxTQUFBQSxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQWlDQSxRQUFBQyxLQUNBLEdBQUFDLEdBQUFKLEVBQUFLLE9BSUEsSUFGQUMsUUFBQUMsS0FBQSwwQkFBQUMsR0FFQUEsS0FBQSxFQUFBLENBRUEsR0FBQUMsSUFBQUMsVUFBQUMsR0FBQUMsT0FBQUMsY0FBQUMsYUFDQUMsTUFBQUMsU0FBQUMsU0FBQUYsTUFBQUMsU0FBQUUsZUFDQVQsR0FBQUMsVUFBQUMsR0FBQUMsT0FBQUMsY0FBQU0sVUFHQSxPQUFBQyxFQUFBQyxLQUNBYixHQUFBLEVBQ0FjLElBQ0FuQixRQUFBTSxHQUNBYyxLQUFBLFNBQ0FDLEdBQ0FoQixHQUFBLEVBQ0FZLEVBQUFDLElBQUFHLEVBQ0FKLEVBQUFLLFdBQUFMLEVBQUFDLElBQUFLLFlBQUFDLE1BQUF6QixFQUFBMEIsTUFDQUMsT0FBQUMsR0FBQU4sRUFDQXBCLEVBQUEyQixhQUdBM0IsRUFBQTJCLGNBR0EzQixHQUFBNEIsT0FBQSxtQ0FHQSxPQUFBNUIsR0FBQTZCLFFBUUEsUUFBQUMsS0FDQSxHQUFBOUIsR0FBQUosRUFBQUssT0FRQSxPQU5BZSxHQUFBQyxJQUFBYyxT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QThFLFVBQUEsR0FBQSxJQUFBOUUsRUFBQThFLFVBQUE5RSxFQUFBOEUsV0FDQSxLQUNBOUUsRUFBQStFLFdBQUEsRUFBQSxHQUFBLEtBQUEvRSxFQUFBK0UsV0FBQSxHQUFBL0UsRUFBQStFLFdBQUEsR0FXQSxRQUFBTSxHQUFBMUUsRUFBQTJFLEdBQ0FDLGFBQUFDLFFBQUE3RSxFQUFBOEUsS0FBQUMsVUFBQUosSUFXQSxRQUFBSyxHQUFBaEYsR0FDQSxNQUFBOEUsTUFBQUcsTUFBQUwsYUFBQU0sUUFBQWxGLElBM0dBLEdBQUEyQixJQUNBd0QsZUFBQXRCLEVBQ0F1QixlQUFBbEIsRUFDQW1CLGVBQUFiLEVBQ0FjLG9CQUFBYixFQUNBYyxnQkFBQWIsRUFDQWMsZ0JBQUFSLEVBR0EsT0FBQXJELEdBckJBbEUsUUFDQUMsT0FBQSxTQUNBQyxRQUFBLFFBQUFLIiwiZmlsZSI6InNlcnZpY2VzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGhpcyBpcyBpbnNwaXJlZCBieS9yaXBwZWQgb2ZmIGZyb20gdmFyaW91cyBiaXRzIG9mIExvdmVGaWVsZCBkZW1vIGNvZGU6XG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlc2FtcGxlcy9pbzIwMTUtY29kZWxhYnMvYmxvYi9tYXN0ZXIvbG92ZWZpZWxkL3NyYy9maW5hbC9sb3ZlZmllbGRfc2VydmljZS5qc1xuICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9sb3ZlZmllbGQvYmxvYi9tYXN0ZXIvZGVtb3Mvb2x5bXBpYV9kYi9hbmd1bGFyL2RlbW8uanNcbiAqIFRoYW5rIHlvdSFcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnanNkYXknKVxuICAgICAgICAuZmFjdG9yeSgnZGJTZXJ2aWNlJywgZGJTZXJ2aWNlKTtcblxuICAgIGRiU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsICckbG9nJywgJyRxJywgJyRyb290U2NvcGUnLCAnVEFCTEUnXTtcblxuICAgIGZ1bmN0aW9uIGRiU2VydmljZSgkaHR0cCwgJGxvZywgJHEsICRyb290U2NvcGUsIFRBQkxFKSB7XG4gICAgICAgIHZhciBkYl8gPSBudWxsO1xuICAgICAgICB2YXIgbm90ZVRhYmxlXyA9IG51bGw7XG4gICAgICAgIHZhciBpc0Nvbm5lY3RpbmdfID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBkYl86IGRiXyxcbiAgICAgICAgICAgIG5vdGVUYWJsZV86IG5vdGVUYWJsZV8sXG5cbiAgICAgICAgICAgIGNvbm5lY3Q6IGNvbm5lY3QsXG4gICAgICAgICAgICBpbml0RGF0YWJhc2U6IGluaXREYXRhYmFzZVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYWxpemVzIGEgZGF0YWJhc2UgY29ubmVjdGlvbi5cbiAgICAgICAgICogQHJldHVybiB7IWFuZ3VsYXIuJHEuUHJvbWlzZX0gLSBwcm9taXNlIGlzIHJlc29sdmVkIHdoZW4gdGhlIGRiXyBhbmQgbm90ZVRhYmxlXyBwcm9wZXJ0aWVzIGhhdmUgaGFkIHZhbHVlcyBhc3NpZ25lZCB0byB0aGVtXG4gICAgICAgICAqXG4gICAgICAgICAqIE5PVEU6IDIwMTUvMTAvMTBcbiAgICAgICAgICogICAgICAgV2hlbiBubyBjb25uZWN0aW9uIG9wdGlvbnMgYXJlIHNldCBMb3ZlRmllbGQgZG9lcyBzb21lIGZlYXR1cmUgZGV0ZWN0aW9uIHRvIGRldGVybWluZSB3aGljaCBiYWNraW5nIHN0b3JlIHRvIHVzZS5cbiAgICAgICAgICogICAgICAgSWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgSW5kZXhlZERiIGl0IHVzZXMgdGhhdCwgdGhlbiBmYWxscyBiYWNrIHRvIFdlYlNxbCBhbmQgZmluYWxseSB0byBhbiBcImluIG1lbW9yeVwiIGRhdGEgc3RvcmUuXG4gICAgICAgICAqICAgICAgIEkgZm91bmQgd2hlbiBkZWJ1Z2dpbmcgb24gYWN0dWFsIGRldmljZXMgdGhhdCBMb3ZlRmllbGQgY2hvc2UgdGhlIGluIG1lbW9yeSAobGYuc2NoZW1hLkRhdGFTdG9yZVR5cGUuTUVNT1JZKSBzdG9yZVxuICAgICAgICAgKiAgICAgICBvbiBpT1Mgd2hpY2ggZGlkbid0IHdvcmsgc28gd2VsbCBzbyBoZXJlIHdlIGVuc3VyZSBXZWJTcWwgaXMgdXNlZCBmb3IgaU9TIGFuZCBBbmRyb2lkIGRldmljZXMuXG4gICAgICAgICAqICAgICAgIEluZGV4ZWREYiBzZWVtZWQgdG8gd29yayB3ZWxsIG9uIGRlc2t0b3AgYnJvd3NlcnMuXG4gICAgICAgICAqICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wM19saWZlX29mX2RiLm1kIzMxMS1jb25uZWN0LW9wdGlvbnNcbiAgICAgICAgICogICAgICAgaHR0cHM6Ly9jb3Jkb3ZhLmFwYWNoZS5vcmcvZG9jcy9lbi81LjEuMS9jb3Jkb3ZhL3N0b3JhZ2Uvc3RvcmFnZS5odG1sXG4gICAgICAgICAqICAgICAgIGh0dHA6Ly9jYW5pdXNlLmNvbS8jZmVhdD1pbmRleGVkZGJcbiAgICAgICAgICogICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9sb3ZlZmllbGQvYmxvYi9tYXN0ZXIvZG9jcy9kZC8wMl9kYXRhX3N0b3JlLm1kIzI1LXdlYnNxbC1zdG9yZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gY29ubmVjdCgpIHtcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnY29ubmVjdCgpIGlzQ29ubmVjdGluZ18nLCBpc0Nvbm5lY3RpbmdfKTtcblxuICAgICAgICAgICAgaWYgKGlzQ29ubmVjdGluZ18gPT09IGZhbHNlKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY29ubmVjdGlvbk9wdGlvbnMgPSB7c3RvcmVUeXBlOiBsZi5zY2hlbWEuRGF0YVN0b3JlVHlwZS5JTkRFWEVEX0RCfTtcbiAgICAgICAgICAgICAgICBpZiAoaW9uaWMuUGxhdGZvcm0uaXNJT1MoKSB8fCBpb25pYy5QbGF0Zm9ybS5pc0FuZHJvaWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uT3B0aW9ucyA9IHtzdG9yZVR5cGU6IGxmLnNjaGVtYS5EYXRhU3RvcmVUeXBlLldFQl9TUUx9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlLmRiXyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpc0Nvbm5lY3RpbmdfID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnVpbGRTY2hlbWEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbm5lY3QoY29ubmVjdGlvbk9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGFiYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ29ubmVjdGluZ18gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZS5kYl8gPSBkYXRhYmFzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZS5ub3RlVGFibGVfID0gc2VydmljZS5kYl8uZ2V0U2NoZW1hKCkudGFibGUoVEFCTEUuTm90ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kYiA9IGRhdGFiYXNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgnU3RpbGwgY29ubmVjdGluZyB0byB0aGUgZGF0YWJhc2UnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDaGVja3MgaWYgYW55IGRhdGEgZXhpc3RzIGluIHRoZSBEQi5cbiAgICAgICAgICogQHJldHVybiB7IWFuZ3VsYXIuJHEuUHJvbWlzZS48IWJvb2xlYW4+fVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gY2hlY2tGb3JFeGlzdGluZ0RhdGEoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBzZXJ2aWNlLmRiXy5zZWxlY3QoKS5mcm9tKHNlcnZpY2Uubm90ZVRhYmxlXykuZXhlYygpLnRoZW4oXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJvd3MpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyb3dzLmxlbmd0aCA+IDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluc2VydHMgc2VlZCBkYXRhIGludG8gdGhlIERCLlxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgLypmdW5jdGlvbiBpbnNlcnRTZWVkRGF0YSgpIHtcbiAgICAgICAgICAgICRsb2cuZGVidWcoJ1BvcHVsYXRpbmcgaW5pdGlhbCBOb3RlIGRhdGEnKTtcblxuICAgICAgICAgICAgdmFyIHVybCA9IFwiLi4vanMvZGF0YS9ub3Rlcy5qc29uXCI7XG4gICAgICAgICAgICBpZiAoaW9uaWMuUGxhdGZvcm0uaXNBbmRyb2lkKCkpIHtcbiAgICAgICAgICAgICAgICB1cmwgPSBcIi9hbmRyb2lkX2Fzc2V0L3d3dy9qcy9kYXRhL25vdGVzLmpzb25cIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW9uaWMuUGxhdGZvcm0uaXNJT1MoKSkge1xuICAgICAgICAgICAgICAgIHVybCA9IFwianMvZGF0YS9ub3Rlcy5qc29uXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsKS50aGVuKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm93cyA9IHJlc3BvbnNlLmRhdGEubWFwKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLm5vdGVUYWJsZV8uY3JlYXRlUm93KG9iaik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmRiXy5pbnNlcnQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmludG8oc2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnZhbHVlcyhyb3dzKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmV4ZWMoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICB9Ki9cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCdWlsZHMgdGhlIGRhdGFiYXNlIHNjaGVtYS5cbiAgICAgICAgICogQHJldHVybiB7IWxmLnNjaGVtYS5CdWlsZGVyfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKiBUT0RPOiB0aGlzIGlzIHdoZXJlIHlvdSB3b3VsZCBkZWZpbmUgeW91ciBkYXRhYmFzZSB0YWJsZXNcbiAgICAgICAgICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9sb3ZlZmllbGQvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjLzAxX3NjaGVtYS5tZFxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRTY2hlbWEoKSB7XG4gICAgICAgICAgICB2YXIgc2NoZW1hQnVpbGRlciA9IGxmLnNjaGVtYS5jcmVhdGUoJ2pzZGF5LW5vdGFzJywgMSk7XG4gICAgICAgICAgICBzY2hlbWFCdWlsZGVyXG4gICAgICAgICAgICAgICAgLmNyZWF0ZVRhYmxlKFRBQkxFLk5vdGUpXG4gICAgICAgICAgICAgICAgLmFkZENvbHVtbignaWQnLCBsZi5UeXBlLklOVEVHRVIpXG4gICAgICAgICAgICAgICAgLmFkZENvbHVtbigncGFsZXN0cmEnLCBsZi5UeXBlLlNUUklORylcbiAgICAgICAgICAgICAgICAuYWRkQ29sdW1uKCd0ZXh0JywgbGYuVHlwZS5TVFJJTkcpXG4gICAgICAgICAgICAgICAgLmFkZFByaW1hcnlLZXkoWydpZCddKVxuICAgICAgICAgICAgICAgIC5hZGRJbmRleCgnaWR4X3BhbGVzdHJhJywgWydwYWxlc3RyYSddKTtcbiAgICAgICAgICAgIHJldHVybiBzY2hlbWFCdWlsZGVyO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ29ubmVjdHMgdG8gYW5kIHNlZWRzIHRoZSBkYXRhYmFzZSB3aXRoIHNvbWUgZHVtbXkgZGF0YSBpZiBubyBkYXRhIGV4aXN0cy5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGluaXREYXRhYmFzZSgpIHtcbiAgICAgICAgICAgICRsb2cuZGVidWcoJ0F0dGVtcHQgdG8gY29ubmVjdCB0byBhbmQgc2VlZCB0aGUgZGF0YWJhc2UnKTtcbiAgICAgICAgICAgIGNvbm5lY3QoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvdmVmaWVsZC1zdGFydGVyLWV2ZW50OmRiQ29ubmVjdGVkJyk7XG4gICAgICAgICAgICAgICAgY2hlY2tGb3JFeGlzdGluZ0RhdGEoKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGF0YUV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyppZiAoZGF0YUV4aXN0cyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRTZWVkRGF0YSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG92ZWZpZWxkLXN0YXJ0ZXItZXZlbnQ6c2VlZERhdGFJbnNlcnRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0qL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIFNlcnZpw6dvYSBkZSBhYnN0cmHDp8OjbyBkbyBGaXJlYmFzZVxuICAgICAqIEBhdXRob3IgV2FsdGVyIEdhbmRhcmVsbGEgPHdhbHRlci53Z2JuQGdtYWlsLmNvbT5cbiAgICAgKiBAbWVtYmVyb2YganNkYXlcbiAgICAgKiBAdmVyc2lvbiAxLjAuMFxuICAgICAqL1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnanNkYXknKVxuICAgICAgICAuZmFjdG9yeSgnZmlyZVNlcnZpY2UnLCBmaXJlU2VydmljZSk7XG5cbiAgICBmaXJlU2VydmljZS4kaW5qZWN0ID0gWyckZmlyZWJhc2VBcnJheScsICckZmlyZWJhc2VPYmplY3QnLCAnVXRpbHMnLCAnJGlvbmljTG9hZGluZycsICckaW9uaWNQb3B1cCddO1xuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIGpzZGF5XG4gICAgICogQG5nZG9jIGZhY3RvcnlcbiAgICAgKiBAbmFtZSBmaXJlU2VydmljZVxuICAgICAqIEBwYXJhbSB7cHJvdmlkZXJ9ICRmaXJlYmFzZUFycmF5IEFic3RyYcOnw6NvIGRvIEZpcmViYXNlIEFycmF5XG4gICAgICogQHBhcmFtIHtmYWN0b3J5fSBVdGlscyBDb25qdW50byBkZSBmdW7Dp8O1ZXMgZGUgdXRpbGlkYWRlXG4gICAgICogQHBhcmFtIHtwcm92aWRlcn0gJGlvbmljTG9hZGluZyBQcm92aWRlciBwYXJhIGxvYWRlciBkaXJlY3RpdmVcbiAgICAgKiBAcGFyYW0ge3Byb3ZpZGVyfSAkaW9uaWNQb3B1cCBwcm92aWRlciBwYXJhIHBvcHVwIGRpcmVjdGl2ZVxuICAgICAqIEBkZXNjcmlwdGlvblxuICAgICAqICAgTWFuaXB1bGEgb3MgZGFkb3MgZSBmYXogbyBhY2Vzc28gw6EgYmFzZSBkbyBGaXJlYmFzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZpcmVTZXJ2aWNlICgkZmlyZWJhc2VBcnJheSwgJGZpcmViYXNlT2JqZWN0LCBVdGlscywgJGlvbmljTG9hZGluZywgJGlvbmljUG9wdXApIHtcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZVxuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgYXBpS2V5OiBcIkFJemFTeUJkWU53UW9sbEtjeUY2aFFhSkNmc1Z3S0EwX0dNaTlZY1wiLFxuICAgICAgICAgICAgYXV0aERvbWFpbjogXCJqc2RheS1hcHAuZmlyZWJhc2VhcHAuY29tXCIsXG4gICAgICAgICAgICBkYXRhYmFzZVVSTDogXCJodHRwczovL2pzZGF5LWFwcC5maXJlYmFzZWlvLmNvbVwiLFxuICAgICAgICAgICAgc3RvcmFnZUJ1Y2tldDogXCJqc2RheS1hcHAuYXBwc3BvdC5jb21cIlxuICAgICAgICB9O1xuICAgICAgICB2YXIgZmJJbml0ID0gZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcChjb25maWcpO1xuXG4gICAgICAgIHZhciBkYiA9IGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCk7XG4gICAgICAgIHZhciB0cmlsaGFzID0gJGZpcmViYXNlQXJyYXkoZGIuY2hpbGQoJ3RyaWxoYXMnKS5vcmRlckJ5Q2hpbGQoJ3RpbWVzdGFtcCcpKTtcbiAgICAgICAgdmFyIHN5bmMgPSAkZmlyZWJhc2VBcnJheShkYi5jaGlsZCgncGFsZXN0cmFzJykub3JkZXJCeUNoaWxkKCdob3JhJykpO1xuICAgICAgICB2YXIgd29ya3Nob3BzID0gJGZpcmViYXNlQXJyYXkoZGIuY2hpbGQoJ3dvcmtzaG9wcycpKTtcbiAgICAgICAgdmFyIGFwcENvbmZpZyA9ICRmaXJlYmFzZU9iamVjdChkYi5jaGlsZCgnYXBwQ29uZmlnJykpO1xuXG4gICAgICAgIHZhciBfcmV0dXJuID0ge1xuICAgICAgICAgICAgZ2V0QXBwQ29uZmlnOiAgIF9nZXRBcHBDb25maWcsXG4gICAgICAgICAgICBnZXRUcmlsaGFzOiAgICAgX2dldFRyaWxoYXMsXG4gICAgICAgICAgICBnZXRUcmlsaGEgOiAgICAgX2dldFRyaWxoYSxcbiAgICAgICAgICAgIGdldFBhbGVzdHJhczogICBfZ2V0UGFsZXN0cmFzLFxuICAgICAgICAgICAgZ2V0UGFsZXN0cmE6ICAgIF9nZXRQYWxlc3RyYSxcbiAgICAgICAgICAgIGdldENvbWVudGFyaW9zOiBfZ2V0Q29tZW50YXJpb3MsXG4gICAgICAgICAgICBnZXRXb3Jrc2hvcHM6ICAgX2dldFdvcmtzaG9wcyxcbiAgICAgICAgICAgIGFkZFBhbGVzdHJhOiAgICBfYWRkUGFsZXN0cmEsXG4gICAgICAgICAgICBhZGRDb21lbnRhcmlvOiAgX2FkZENvbWVudGFyaW8sXG4gICAgICAgICAgICB1cGRhdGVQYWxlc3RyYTogX3VwZGF0ZVBhbGVzdHJhXG4gICAgICAgIH07XG5cbiAgICAgICAgX2xvYWRpbmcoKTtcblxuICAgICAgICByZXR1cm4gX3JldHVybjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0b3JuYSBvIG9iamV0byBkZSBjb25maWd1cmHDp8Ojb1xuICAgICAgICAgKiBAbWVtYmVyb2YgZmlyZVNlcnZpY2VcbiAgICAgICAgICogQGZ1bmN0aW9uIF9nZXRBcHBDb25maWdcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9nZXRBcHBDb25maWcgKCkge1xuICAgICAgICAgICAgcmV0dXJuIGFwcENvbmZpZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFc2N1dGEgbyBjYXJyZWdhbWVudG8gaW5pY2lhbCBkbyBhcnJheSB2aW5kbyBkbyBGaXJlYmFzZSBleGliaW5kbyB1bSBpb25pY0xvYWRlclxuICAgICAgICAgKiBAbWVtYmVyb2YgZmlyZVNlcnZpY2VcbiAgICAgICAgICogQGZ1bmN0aW9uIF9sb2FkaW5nXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfbG9hZGluZyAoKSB7XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLnNob3coe3RlbXBsYXRlOiAnQ2FycmVnYW5kby4uLid9KTtcbiAgICAgICAgICAgIHN5bmMuJGxvYWRlZChmdW5jdGlvbiAob2spIHtcbiAgICAgICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvKSB7XG4gICAgICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ09wcyEnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7XCI+TsOjbyBmb2kgcG9zc8OtdmVsIGNhcnJlZ2FyIG9zIGRhZG9zLjxicj5WZXJpZmlxdWUgc3VhIGNvbmV4w6NvLjwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgIG9rVHlwZTogJ2J1dHRvbi1lbmVyZ2l6ZWQnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZXRvcm5hIGEgbGlzdGEgZGUgcGFsZXN0cmFzIHZpbmRhIGRvIGZpcmViYXNlXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2dldFBhbGVzdHJhc1xuICAgICAgICAgKiBAcmV0dXJucyB7QXJyYXl9ICAgICAgICAgTGlzdGEgZGUgcGFsZXN0cmFzXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0UGFsZXN0cmFzICgpIHtcbiAgICAgICAgICAgIHJldHVybiBzeW5jO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJldG9ybmEgYSBsaXN0YSBkZSB0cmlsaGFzIHZpbmRhIGRvIGZpcmViYXNlXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2dldFRyaWxoYXNcbiAgICAgICAgICogQHJldHVybnMge0FycmF5fSAgICAgICAgIExpc3RhIGRlIHBhbGVzdHJhc1xuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX2dldFRyaWxoYXMgKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRyaWxoYXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmV0b3JuYSB1bWEgdHJpbGhhIHBhc3NhbmRvLXNlIG8gJGlkXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2dldFRyaWxoYVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2lkXG4gICAgICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0VHJpbGhhIChfaWQpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBmYWxzZTtcblxuICAgICAgICAgICAgdHJpbGhhcy5mb3JFYWNoKGZ1bmN0aW9uIChfdCkge1xuICAgICAgICAgICAgICAgIGlmIChfdC4kaWQgPT0gX2lkKVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBfdDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJldG9ybmEgdW1hIHBhbGVzdHJhIGRhIGxpc3RhXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2dldFBhbGVzdHJhXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBfa2V5ICAgICBBIGtleSBkYSBwYWxlc3RyYSBubyBhcnJheVxuICAgICAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSAgICAgICAgQSBwYWxlc3RyYSBlbmNvbnRyYWRhXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0UGFsZXN0cmEgKF9rZXkpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuXG4gICAgICAgICAgICBzeW5jLmZvckVhY2goZnVuY3Rpb24gKF92YWwpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3ZhbC4kaWQgPT0gX2tleSlcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gX3ZhbDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkaWNpb25hIHVtIG9iamV0byBwYWxlc3RyYSDDoCBsaXN0YVxuICAgICAgICAgKiBAbWVtYmVyb2YgZmlyZVNlcnZpY2VcbiAgICAgICAgICogQGZ1bmN0aW9uIF9hZGRQYWxlc3RyYVxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gX3BhbGVzdHJhICAgIE9iamV0byByZXByZXNlbnRhbmRvIHVtYSBwYWxlc3RyYVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX2FkZFBhbGVzdHJhIChfcGFsZXN0cmEpIHtcbiAgICAgICAgICAgIHN5bmMuJGFkZChfcGFsZXN0cmEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEF0dWFsaXphIHVtIGl0ZW0gZG8gb2JqZXRvIHBhbGVzdHJhXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX3VwZGF0ZVBhbGVzdHJhXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBfcGFsZXN0cmEgICAgT2JqZXRvIHJlcHJlc2VudGFuZG8gdW1hIHBhbGVzdHJhXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBfaXRlbSAgICAgICAgQ2hhdmUgZG8gaXRlbSBhIHNlciBhdHVhbGl6YWRvXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfdXBkYXRlUGFsZXN0cmEgKF9wYWxlc3RyYSwgX2l0ZW0pIHtcbiAgICAgICAgICAgIGRiLmNoaWxkKCdwYWxlc3RyYXMnKS5jaGlsZChfcGFsZXN0cmEuJGlkKS5jaGlsZChfaXRlbSkuc2V0KF9wYWxlc3RyYVtfaXRlbV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkaWNpb25hIHVtIGNvbWVudMOhcmlvIMOgIHBhbGVzdHJhXG4gICAgICAgICAqIEBtZW1iZXJvZiBmaXJlU2VydmljZVxuICAgICAgICAgKiBAZnVuY3Rpb24gX2FkZENvbWVudGFyaW9cbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IF9wYWxlc3RyYSAgICBBIHBhbGVzdHJhIGEgc2VyIGFkaWNpb25hZGEgbyBjb21lbnTDoXJpb1xuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gX2NvbWVudGFyaW8gIE8gY29tZW50w6FyaW9cbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9hZGRDb21lbnRhcmlvIChfcGFsZXN0cmEsIF9jb21lbnRhcmlvKSB7XG4gICAgICAgICAgICB2YXIgX2R0ID0gbmV3IERhdGUoKTtcblxuICAgICAgICAgICAgX2NvbWVudGFyaW8ucmVnaXN0cm8gPSBfZHQuZ2V0VGltZSgpO1xuICAgICAgICAgICAgX3BhbGVzdHJhLmNvbWVudGFyaW9zID0gX3BhbGVzdHJhLmNvbWVudGFyaW9zIHx8IHt9O1xuICAgICAgICAgICAgX3BhbGVzdHJhLmNvbWVudGFyaW9zW19kdC5nZXRUaW1lKCkudG9TdHJpbmcoKV0gPSBfY29tZW50YXJpbztcblxuICAgICAgICAgICAgZGIuY2hpbGQoJ3BhbGVzdHJhcycpLmNoaWxkKF9wYWxlc3RyYS4kaWQpLmNoaWxkKFwiY29tZW50YXJpb3NcIikuY2hpbGQoX2R0LmdldFRpbWUoKS50b1N0cmluZygpKS5zZXQoX2NvbWVudGFyaW8pO1xuICAgICAgICAgICAgcmV0dXJuIF9nZXRDb21lbnRhcmlvcyhfcGFsZXN0cmEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExpc3RhIG9zIGNvbWVudGFyaW9zIGRlIHVtYSBwYWxlc3RyYVxuICAgICAgICAgKiBAbWVtYmVyb2YgZmlyZVNlcnZpY2VcbiAgICAgICAgICogQGZ1bmN0aW9uIF9nZXRDb21lbnRhcmlvc1xuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFsZXN0cmFcbiAgICAgICAgICogQHJldHVybnMge0FycmF5fSBMaXN0YSBkZSBjb21lbnRhcmlvc1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX2dldENvbWVudGFyaW9zIChfcGFsZXN0cmEpIHtcbiAgICAgICAgICAgIGlmICghX3BhbGVzdHJhLmNvbWVudGFyaW9zKVxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcblxuICAgICAgICAgICAgdmFyIHJlcyA9IFtdO1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoX3BhbGVzdHJhLmNvbWVudGFyaW9zKS5mb3JFYWNoKGZ1bmN0aW9uKF9rZXkpe1xuICAgICAgICAgICAgICAgIHJlcy5wdXNoKF9wYWxlc3RyYS5jb21lbnRhcmlvc1tfa2V5XSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogRGV2b2x2ZSBhIGxpc3RhIGNvbSBvcyB3b3Jrc2hvcHNcbiAgICAgICAgICogQG1lbWJlcm9mIGZpcmVTZXJ2aWNlXG4gICAgICAgICAqIEBmdW5jdGlvbiBfZ2V0V29ya3Nob3BzXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfZ2V0V29ya3Nob3BzICgpIHtcbiAgICAgICAgICAgIHJldHVybiB3b3Jrc2hvcHM7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2pzZGF5JylcbiAgICAgICAgLmZhY3RvcnkoJ25vdGVTZXJ2aWNlJywgbm90ZVNlcnZpY2UpO1xuXG4gICAgbm90ZVNlcnZpY2UuJGluamVjdCA9IFsnJGxvZycsICckcScsICdkYlNlcnZpY2UnXTtcblxuICAgIGZ1bmN0aW9uIG5vdGVTZXJ2aWNlKCRsb2csICRxLCBkYlNlcnZpY2UpIHtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGFkZDogYWRkLFxuICAgICAgICAgICAgZWRpdDogZWRpdCxcbiAgICAgICAgICAgIGdldEFsbDogZ2V0QWxsLFxuICAgICAgICAgICAgZ2V0QnlJZDogZ2V0QnlJZCxcbiAgICAgICAgICAgIGdldEJ5UGFsZXN0cmE6IGdldEJ5UGFsZXN0cmEsXG4gICAgICAgICAgICByZW1vdmU6IHJlbW92ZVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vL1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZHMgYSBuZXcgbm90ZSB0byB0aGUgZGIuXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSAtIHRoZSB0ZXh0IG9mIHRoZSBub3RlIHRvIHVwZGF0ZVxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlfVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gYWRkKHBhbGVzdHJhLCB0ZXh0KSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfaG9qZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIHJvdyA9IGRiU2VydmljZS5ub3RlVGFibGVfLmNyZWF0ZVJvdyh7XG4gICAgICAgICAgICAgICAgICAgICdpZCc6IF9ob2plLmdldFRpbWUoKSxcbiAgICAgICAgICAgICAgICAgICAgJ3BhbGVzdHJhJzogcGFsZXN0cmEsXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0JzogdGV4dFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGRvY3M6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvbG92ZWZpZWxkL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlYy8wNF9xdWVyeS5tZCM0Mi1pbnNlcnQtcXVlcnktYnVpbGRlclxuICAgICAgICAgICAgICAgIGRiU2VydmljZS5kYl8uaW5zZXJ0T3JSZXBsYWNlKClcbiAgICAgICAgICAgICAgICAgICAgLmludG8oZGJTZXJ2aWNlLm5vdGVUYWJsZV8pXG4gICAgICAgICAgICAgICAgICAgIC52YWx1ZXMoW3Jvd10pXG4gICAgICAgICAgICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVcGRhdGVzIGEgbm90ZSBpbiB0aGUgZGIuXG4gICAgICAgICAqIEBwYXJhbSB7Z3VpZH0gLSB0aGUgaWQgb2YgdGhlIG5vdGUgdG8gdXBkYXRlXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSAtIHRoZSB0ZXh0IG9mIHRoZSBub3RlIHRvIHVwZGF0ZVxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlfVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZWRpdChpZCwgdGV4dCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgZGJTZXJ2aWNlLmNvbm5lY3QoKS50aGVuKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBkb2NzOiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL3NwZWMvMDRfcXVlcnkubWQjNDMtdXBkYXRlLXF1ZXJ5LWJ1aWxkZXJcbiAgICAgICAgICAgICAgICBkYlNlcnZpY2UuZGJfLnVwZGF0ZShkYlNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgLnNldChkYlNlcnZpY2Uubm90ZVRhYmxlXy50ZXh0LCB0ZXh0KVxuICAgICAgICAgICAgICAgICAgICAud2hlcmUoZGJTZXJ2aWNlLm5vdGVUYWJsZV8uaWQuZXEoaWQpKVxuICAgICAgICAgICAgICAgICAgICAuZXhlYygpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0cyBhbGwgbm90ZXMgZnJvbSB0aGUgIGRiLlxuICAgICAgICAgKiBAcmV0dXJuIHshYW5ndWxhci4kcS5Qcm9taXNlLjwhQXJyYXk8IU9iamVjdD4+fVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gZ2V0QWxsKCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgZGJTZXJ2aWNlLmNvbm5lY3QoKS50aGVuKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIC8vIFRPRE86IE9ic2VydmUgdGhlIHNlbGVjdCBxdWVyeSB0byBzYXZlIGhhdmluZyB0byBleHBsaWNpdGx5IGNhbGwgZ2V0Tm90ZXMoKSBhZnRlciBhbiBJTlNFUlQvVVBEQVRFIG9yIERFTEVURSBkb2NzOiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL3NwZWMvMDRfcXVlcnkubWQjNDYtb2JzZXJ2ZXJzXG4gICAgICAgICAgICAgICAgLy8gZGIub2JzZXJ2ZShzZWxlY3RRdWVyeSwgaGFuZGxlcik7XG5cbiAgICAgICAgICAgICAgICAvLyBTRUxFQ1QgZG9jczogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9sb3ZlZmllbGQvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjLzA0X3F1ZXJ5Lm1kIzQxOC1yZXRyaWV2YWwtb2YtcXVlcnktcmVzdWx0c1xuICAgICAgICAgICAgICAgIGRiU2VydmljZS5kYl8uc2VsZWN0KClcbiAgICAgICAgICAgICAgICAgICAgLmZyb20oZGJTZXJ2aWNlLm5vdGVUYWJsZV8pXG4gICAgICAgICAgICAgICAgICAgIC5leGVjKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAocm93cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocm93cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQ6ICcsIHJlYXNvbik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXRzIGEgc2luZ2xlIG5vdGUgZnJvbSB0aGUgZGIuXG4gICAgICAgICAqIEBwYXJhbSB7Z3VpZH0gLSB0aGUgaWQgb2YgdGhlIG5vdGUgdG8gcmV0cmlldmVcbiAgICAgICAgICogQHJldHVybiB7IWFuZ3VsYXIuJHEuUHJvbWlzZS48IU9iamVjdD59XG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBnZXRCeUlkKGlkKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgZGJTZXJ2aWNlLmRiXy5zZWxlY3QoKVxuICAgICAgICAgICAgICAgICAgICAuZnJvbShkYlNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgLndoZXJlKGRiU2VydmljZS5ub3RlVGFibGVfLmlkLmVxKGlkKSlcbiAgICAgICAgICAgICAgICAgICAgLmV4ZWMoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHJlc3VsdHMpICYmIHJlc3VsdHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0c1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvZy5lcnJvcignTm90ZSBub3QgZm91bmQgd2l0aCBpZCBvZjogJyArIGlkLCByZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRCeVBhbGVzdHJhKHBhbGVzdHJhKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBkYlNlcnZpY2UuY29ubmVjdCgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgZGJTZXJ2aWNlLmRiXy5zZWxlY3QoKVxuICAgICAgICAgICAgICAgICAgICAuZnJvbShkYlNlcnZpY2Uubm90ZVRhYmxlXylcbiAgICAgICAgICAgICAgICAgICAgLndoZXJlKGRiU2VydmljZS5ub3RlVGFibGVfLnBhbGVzdHJhLmVxKHBhbGVzdHJhKSlcbiAgICAgICAgICAgICAgICAgICAgLmV4ZWMoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVsZXRlcyBhIG5vdGUgZnJvbSB0aGUgZGIuXG4gICAgICAgICAqIEBwYXJhbSB7Z3VpZH0gLSB0aGUgaWQgb2YgdGhlIG5vdGUgdG8gcmV0cmlldmVcbiAgICAgICAgICogQHJldHVybiB7IWFuZ3VsYXIuJHEuUHJvbWlzZX0gLSBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgcm93IGhhcyBiZWVuIGRlbGV0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZShpZCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgZGJTZXJ2aWNlLmNvbm5lY3QoKS50aGVuKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIC8vIERFTEVURSBkb2NzOiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2xvdmVmaWVsZC9ibG9iL21hc3Rlci9kb2NzL3NwZWMvMDRfcXVlcnkubWQjNDQtZGVsZXRlLXF1ZXJ5LWJ1aWxkZXJcbiAgICAgICAgICAgICAgICBkYlNlcnZpY2UuZGJfLmRlbGV0ZSgpXG4gICAgICAgICAgICAgICAgICAgIC5mcm9tKGRiU2VydmljZS5ub3RlVGFibGVfKVxuICAgICAgICAgICAgICAgICAgICAud2hlcmUoZGJTZXJ2aWNlLm5vdGVUYWJsZV8uaWQuZXEoaWQpKVxuICAgICAgICAgICAgICAgICAgICAuZXhlYygpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogQ3JlYXRlcyBhIGd1aWQuXG4gICAgICAgICAqIEByZXR1cm4ge2d1aWR9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqIGNvcHkvcGFzdGVkIGZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTA1MDc0LzI2NTI5MTAgLSB0aGFuayB5b3VcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIGd1aWQoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBzNCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcbiAgICAgICAgICAgICAgICAgICAgLnRvU3RyaW5nKDE2KVxuICAgICAgICAgICAgICAgICAgICAuc3Vic3RyaW5nKDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24gQmlibGlvdGVjYSBkZSBmdW7Dp8O1ZXMgdXRpbGl0w6FyaWFzXG4gICAgICogQGF1dGhvciBXYWx0ZXIgR2FuZGFyZWxsYSA8d2FsdGVyLndnYm5AZ21haWwuY29tPlxuICAgICAqIEBtZW1iZXJvZiBqc2RheVxuICAgICAqIEB2ZXJzaW9uIDEuMC4wXG4gICAgICovXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdqc2RheScpXG4gICAgICAgIC5mYWN0b3J5KCdVdGlscycsIFV0aWxzKTtcblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXJvZiBqc2RheVxuICAgICAqIEBuZ2RvYyBmYWN0b3J5XG4gICAgICogQG5hbWUgVXRpbHNcbiAgICAgKiBAZGVzY3JpcHRpb25cbiAgICAgKiAgIFByb3bDqiBmdW7Dp8O1ZXMgdXRpbGl0w6FyaWFzIHBhcmEgdXNvIGRhIGFwbGljYcOnw6NvXG4gICAgICovXG4gICAgZnVuY3Rpb24gVXRpbHMgKCkge1xuICAgICAgICB2YXIgX3JldHVybiA9IHtcbiAgICAgICAgICAgIHBhcnNlU3RyVG9EYXRlOiAgICAgICAgIF9wYXJzZVN0clRvRGF0ZSxcbiAgICAgICAgICAgIHBhcnNlRGF0ZVRvU3RyOiAgICAgICAgIF9wYXJzZURhdGVUb1N0cixcbiAgICAgICAgICAgIHBhcnNlVGltZVRvU3RyOiAgICAgICAgIF9wYXJzZVRpbWVUb1N0cixcbiAgICAgICAgICAgIHBhcnNlU2hvcnREYXRlVG9TdHI6ICAgIF9wYXJzZVNob3J0RGF0ZVRvU3RyLFxuICAgICAgICAgICAgc2V0TG9jYWxTdG9yYWdlOiAgICAgICAgX3NldExvY2FsU3RvcmFnZSxcbiAgICAgICAgICAgIGdldExvY2FsU3RvcmFnZTogICAgICAgIF9nZXRMb2NhbFN0b3JhZ2VcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gX3JldHVybjtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVHJhbnNmb3JtYSB1bWEgc3RyaW5nIGZvcm1hdGFkYSBjb21vIGRkL21tL3l5eXkgcGFyYSB1bSBvYmpldG8gRGF0ZVxuICAgICAgICAgKiBAbWVtYmVyb2YgVXRpbHNcbiAgICAgICAgICogQGZ1bmN0aW9uIF9wYXJzZVN0clRvRGF0ZVxuICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gX2RhdGUgICAgICAgIERhdGEgbm8gZm9ybWF0byBkZC9tbS95eXl5XG4gICAgICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gX3RpbWUgICAgICAgQm9vbGVhbm8gc2UgZGV2ZSBzZXIgY29uc2lkZXJhZG8gYSBob3JhXG4gICAgICAgICAqIEByZXR1cm5zIHtudW1iZXJ9ICAgICAgICAgICAgVGltZXN0YW1wIGRhIGRhdGFcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9wYXJzZVN0clRvRGF0ZSAoX2RhdGUsIF90aW1lKSB7XG4gICAgICAgICAgICBfdGltZSA9IF90aW1lIHx8IGZhbHNlO1xuICAgICAgICAgICAgdmFyIF9kYXRlID0gX2RhdGUuc3BsaXQoJyAnKTtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgRGF0ZShcbiAgICAgICAgICAgICAgICBfZGF0ZVswXS5zcGxpdCgnLycpWzJdLFxuICAgICAgICAgICAgICAgIHBhcnNlSW50KF9kYXRlWzBdLnNwbGl0KCcvJylbMV0pIC0gMSxcbiAgICAgICAgICAgICAgICBfZGF0ZVswXS5zcGxpdCgnLycpWzBdLFxuICAgICAgICAgICAgICAgIF90aW1lID8gX2RhdGVbMV0uc3BsaXQoJzonKVswXSA6IDAsXG4gICAgICAgICAgICAgICAgX3RpbWUgPyBfZGF0ZVsxXS5zcGxpdCgnOicpWzFdIDogMCxcbiAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgIDBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0LmdldFRpbWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmFuc2Zvcm1hIHVtIHRpbWVzdGFtcCBwYXJhIGRhdGEgbm8gZm9ybWF0byBkZC9tbS95eXl5IFtoaDptbV1cbiAgICAgICAgICogQG1lbWJlcm9mIFV0aWxzXG4gICAgICAgICAqIEBmdW5jdGlvbiBfcGFyc2VEYXRlVG9TdHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IF9kYXRlICAgICAgICBUaW1lc3RhbXAgZGEgZGF0YVxuICAgICAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IF90aW1lICAgICAgIEJvb2xlYW5vIHNlIGRldmUgc2VyIGNvbnNpZGVyYWRvIGEgaG9yYVxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSAgICAgICAgICAgIEEgZGF0YSBubyBmb3JtYXRvIGRkL21tL3l5eXkgW2hoOm1tXVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX3BhcnNlRGF0ZVRvU3RyIChfZGF0ZSwgX3RpbWUpe1xuICAgICAgICAgICAgX3RpbWUgPSBfdGltZSB8fCBmYWxzZTtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgRGF0ZShfZGF0ZSk7XG4gICAgICAgICAgICByZXR1cm4gKHJlc3VsdC5nZXREYXRlKCkgPCAxMCA/IFwiMFwiK3Jlc3VsdC5nZXREYXRlKCkgOiByZXN1bHQuZ2V0RGF0ZSgpKVxuICAgICAgICAgICAgICAgICtcIi9cIlxuICAgICAgICAgICAgICAgICsocmVzdWx0LmdldE1vbnRoKCkrMSA8IDEwID8gXCIwXCIrKHJlc3VsdC5nZXRNb250aCgpKzEpIDogcmVzdWx0LmdldE1vbnRoKCkrMSlcbiAgICAgICAgICAgICAgICArXCIvXCIrcmVzdWx0LmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgICsoX3RpbWUgPyBcIiBcIityZXN1bHQuZ2V0SG91cnMoKS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgK1wiOlwiXG4gICAgICAgICAgICAgICAgK3Jlc3VsdC5nZXRNaW51dGVzKCkudG9TdHJpbmcoKSA6IFwiXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYW5zZm9ybWEgdW0gdGltZXN0YW1wIGVtIGhvcmEgbm8gZm9ybWF0byBoaDptbVxuICAgICAgICAgKiBAbWVtYmVyb2YgVXRpbHNcbiAgICAgICAgICogQGZ1bmN0aW9uIF9wYXJzZVRpbWVUb1N0clxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gX2RhdGUgICAgICAgIFRpbWVzdGFtcCBkYSBkYXRhXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9ICAgICAgICAgICAgQSBob3JhIG5vIGZvcm1hdG8gaGg6bW1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIF9wYXJzZVRpbWVUb1N0ciAoX2RhdGUpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgRGF0ZShfZGF0ZSk7XG4gICAgICAgICAgICByZXR1cm4gKHJlc3VsdC5nZXRIb3VycygpIDwgMTAgPyAnMCcgKyByZXN1bHQuZ2V0SG91cnMoKSA6IHJlc3VsdC5nZXRIb3VycygpKVxuICAgICAgICAgICAgICAgICtcIjpcIlxuICAgICAgICAgICAgICAgICsocmVzdWx0LmdldE1pbnV0ZXMoKSA8IDEwID8gJzAnICsgcmVzdWx0LmdldE1pbnV0ZXMoKSA6IHJlc3VsdC5nZXRNaW51dGVzKCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYW5zZm9ybWEgdW0gdGltZXN0YW1wIG51bWEgZGF0YSBjdXJ0YSBubyBmb3JtYXRvIGRkL21tXG4gICAgICAgICAqIEBtZW1iZXJvZiBVdGlsc1xuICAgICAgICAgKiBAZnVuY3Rpb24gX3BhcnNlU2hvcnREYXRlVG9TdHJcbiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IF9kYXRlICAgICAgICBUaW1lc3RhbXAgZGEgZGF0YVxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSAgICAgICAgICAgIEEgZGF0YSBubyBmb3JtYXRvIGRkL21tXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfcGFyc2VTaG9ydERhdGVUb1N0ciAoX2RhdGUpe1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBEYXRlKF9kYXRlKTtcbiAgICAgICAgICAgIHJldHVybiAocmVzdWx0LmdldERhdGUoKSA8IDEwID8gXCIwXCIrcmVzdWx0LmdldERhdGUoKSA6IHJlc3VsdC5nZXREYXRlKCkpXG4gICAgICAgICAgICAgICAgK1wiL1wiXG4gICAgICAgICAgICAgICAgKyhyZXN1bHQuZ2V0TW9udGgoKSsxIDwgMTAgPyBcIjBcIisocmVzdWx0LmdldE1vbnRoKCkrMSkgOiByZXN1bHQuZ2V0TW9udGgoKSsxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTYWx2YSB1bSBpdGVtIG5vIGxvY2FsU3RvcmFnZSBkbyBkaXNwb3NpdGl2b1xuICAgICAgICAgKiBAbWVtYmVyb2YgVXRpbHNcbiAgICAgICAgICogQGZ1bmN0aW9uIF9zZXRMb2NhbFN0b3JhZ2VcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IF9pdGVtICAgICBDaGF2ZSBkZSBpZGVudGlmaWNhw6fDo28gZG8gaXRlbSBubyBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IF92YWxvciAgICBWYWxvciBkbyBpdGVtXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBmdW5jdGlvbiBfc2V0TG9jYWxTdG9yYWdlIChfaXRlbSwgX3ZhbG9yKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShfaXRlbSwgSlNPTi5zdHJpbmdpZnkoX3ZhbG9yKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVzZ2F0YSB1bSBpdGVtIHNhbHZvIG5vIGxvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAbWVtYmVyb2YgVXRpbHNcbiAgICAgICAgICogQGZ1bmN0aW9uIF9nZXRMb2NhbFN0b3JhZ2VcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IF9pdGVtICAgICBDaGF2ZSBkZSBpZGVudGlmaWNhw6fDo28gZG8gaXRlbSBubyBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICogQHJldHVybnMge09iamVjdH0gICAgICAgICBJdGVtIGRvIGxvY2FsU3RvcmFnZVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gX2dldExvY2FsU3RvcmFnZSAoX2l0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKF9pdGVtKSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
